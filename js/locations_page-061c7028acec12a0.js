(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9453],{1186:e=>{e.exports={groupName:"styles_groupName__vSGiw",back__label:"styles_back__label__eQnBN",container:"styles_container__lTVPo",content:"styles_content__dKt8H",back:"styles_back__K4By2",back__icon:"styles_back__icon__iNmRP",group:"styles_group__o4w_y",isActive:"styles_isActive__bzTCf",active:"styles_active__LFsGJ",groupChild:"styles_groupChild__ucDbA",groupChildWrapper:"styles_groupChildWrapper__Gp6so",groupChildName:"styles_groupChildName__5clQq"}},27147:e=>{e.exports={title:"styles_title__mx6vC",text:"styles_text__wPq7U",container:"styles_container__GSTmH",active:"styles_active__VMiPQ",content:"styles_content__SB25e"}},28153:e=>{e.exports={container:"styles_container__w49f3",content:"styles_content__JMcSq",scroll:"styles_scroll__gDz5f",item:"styles_item__z0CGE"}},31134:e=>{e.exports={placeholderButton:"styles_placeholderButton__nWpmC",container:"styles_container__BDg5e",absolute:"styles_absolute__JAclG",globe:"styles_globe__IYuE6",map:"styles_map__70sGj",map__back:"styles_map__back__5ibIq",arrow:"styles_arrow__8tQjS",arrowPrev:"styles_arrowPrev__NV_Om",arrowNext:"styles_arrowNext__zzny2",layer:"styles_layer__JeSbv",layerTop:"styles_layerTop__G9rDN",layerBottom:"styles_layerBottom__FJAIb",onboard:"styles_onboard__Ma0lz",hint:"styles_hint__COp7n"}},41436:e=>{e.exports={container:"styles_container__53Unv"}},59790:(e,n,t)=>{"use strict";t.d(n,{default:()=>e7});var i={};t.r(i),t.d(i,{css:()=>eh,id:()=>ed,plugin:()=>em});var a=t(95155),o=t(36274),r=t(12115),s=t(39583),l=t(92226),c=t(64804),u=t(6816),d=t(42506),h=t(28153),m=t.n(h);let v=e=>{let{children:n,size:t=100,count:i,setState:h}=e,v=(0,r.useRef)(null),g=(0,r.useRef)([]),[f,p]=(0,r.useState)(0),{scrollYProgress:b,scrollY:x}=(0,s.L)({target:v,offset:["start end","end start"]}),y=(0,l.V)(x),w=(0,c.z)(y,{damping:50,stiffness:400}),_=(0,u.G)(w,[0,1e3],[0,5],{clamp:!1}),L=(0,o.W)(v,{margin:"0px 0px 0px 0px"}),S=()=>{h({isInView:L,activeSection:f,scrollYProgress:b.get(),velocityFactor:_.get(),sectionProgress:P()})},P=()=>b.get()*i-f,D=e=>{let n=Math.floor(e*i);S(),n!==f&&n<=i&&p(n)};return(0,d.L)(b,"change",e=>{D(e)}),(0,r.useEffect)(()=>{S()},[]),(0,r.useEffect)(()=>{D(b.get())},[L]),(0,a.jsxs)("div",{className:m().container,ref:v,style:{"--st-height":"".concat(t*i,"vh"),"--st-count":i,"--st-size":"".concat(t,"vh")},children:[(0,a.jsx)("div",{className:m().content,children:n}),(0,a.jsx)("div",{className:m().scroll,children:[...Array(i)].map((e,n)=>(0,a.jsx)("div",{ref:e=>{g.current[n]=e},className:m().item},n))})]})};var g=t(90772),f=t(86842),p=t(15239),b=t(85339),x=t(42003),y=t(76807),w=t.n(y);let _=e=>{let{index:n,ref:t,onPointerDown:i,animate:o,active:r,focus:s}=e;return(0,a.jsx)(f.P.div,{role:"button",className:[w().container,r?w().active:w().inactive,s?w().focus:""].join(" "),onPointerDown:i,initial:{"--enter":0,"--leave":0},animate:o?{"--enter":1,"--leave":0}:{"--enter":1,"--leave":1},transition:{delay:1.5*!!o,duration:.7,ease:x.we},"data-active":+r,ref:e=>{e&&(t.current[n]=e)},children:(0,a.jsx)("div",{className:w().content,children:(0,a.jsx)("div",{className:w().wrapper,children:(0,a.jsx)(p.default,{className:w().icon,src:"/svg/icon-pin.svg",alt:"Netflix Map Pin",width:20,height:20})})})})};var L=t(1186),S=t.n(L);let P=e=>{let{data:n,animate:t,activeRegion:i,activeCity:o,onChange:s,lock:l,onBack:c}=e,[u,d]=(0,r.useState)([]),[h,m]=(0,r.useState)("");(0,r.useEffect)(()=>{if(i>=0&&o>=0){let e="".concat(i,"-").concat(o);m(e),d(n=>[e,...n])}},[i,o]);let v=e=>h.split("-")[0]===e,g=e=>{s(e)};return(0,a.jsxs)(f.P.div,{className:S().container,initial:{opacity:0},animate:t?{opacity:1}:{opacity:0},transition:{duration:.7,ease:x.we},children:[(0,a.jsxs)(f.P.button,{onPointerDown:c,className:S().back,initial:{opacity:0,pointerEvents:"none"},animate:l?{opacity:1,pointerEvents:"all"}:{opacity:0,pointerEvents:"none"},transition:{duration:.4,ease:x.we},children:[(0,a.jsx)(p.default,{className:S().back__icon,src:"/svg/arrow-left.svg",alt:"Netflix Arrow Left",width:20,height:20}),(0,a.jsx)("span",{className:S().back__label,children:"BACK TO WORLD VIEW"})]}),(0,a.jsx)("div",{className:S().content,children:n.map((e,n)=>(0,a.jsxs)("div",{className:[S().group,h.length>0?S().isActive:"",v("".concat(n))?S().active:""].join(" "),children:[(0,a.jsx)("div",{className:S().groupName,onPointerDown:()=>(e=>{v(e)||g((e=>u.find(n=>n.includes("".concat(e,"-")))||"".concat(e,"-0"))(e))})("".concat(n)),children:e.name}),(0,a.jsx)(f.P.div,{className:S().groupChild,initial:{height:0},animate:v("".concat(n))?{height:"auto"}:{height:0},exit:{height:0},transition:{duration:.7,ease:x.we},children:(0,a.jsx)("div",{className:S().groupChildWrapper,children:e.items&&e.items.sort((e,n)=>e.name.localeCompare(n.name)).map((e,t)=>(0,a.jsx)("div",{onPointerDown:()=>g("".concat(n,"-").concat(t)),className:[S().groupChildName,h==="".concat(n,"-").concat(t)?S().active:""].join(" "),children:e.name},"".concat(n,"-").concat(t)))})})]},n))})]})};var D=t(52619),C=t.n(D),E=t(23790),I=t(78200),U=t.n(I);let M=e=>{let{animate:n,active:t,data:i,activeCity:o,activeRegion:s}=e,[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(!1),h=(0,r.useRef)(null),[m,v]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[w,_]=(0,r.useState)("");(0,r.useEffect)(()=>{d(!1),h.current=setTimeout(()=>{o>=0&&i[s]&&i[s].items&&i[s].items[o]&&(c(i[s].items[o].name),i[s].items[o].primaryUrl&&v(i[s].items[o].primaryUrl),i[s].items[o].secondaryUrl&&p(i[s].items[o].secondaryUrl))},1e3)},[o,s,t]),(0,r.useEffect)(()=>{l.length>0&&d(!0),L()},[l]),(0,r.useEffect)(()=>(t||(d(!1),h.current=setTimeout(()=>{c(""),L()},1e3)),()=>{L()}),[t]),(0,r.useEffect)(()=>{m?m.includes("explore.jobs.netflix.net")||m.includes("jobs.netflix.com")?y((0,E.Z)(m)):y(m):y("https://jobs.netflix.com")},[m]),(0,r.useEffect)(()=>{g?g.includes("explore.jobs.netflix.net")||g.includes("jobs.netflix.com")?_((0,E.Z)(g)):_(g):_("https://jobs.netflix.com")},[g]);let L=()=>{h.current&&clearTimeout(h.current)};return(0,a.jsxs)(f.P.div,{className:[U().container,t?U().active:U().inactive].join(" "),children:[(0,a.jsx)("div",{className:U().content,children:(0,a.jsx)("div",{className:U().contentRow,children:(0,a.jsx)(f.P.div,{className:U().name,initial:{y:"25%",opacity:0},animate:n&&u?{y:"0%",opacity:1}:{y:"25%",opacity:0},transition:{opacity:{delay:n&&u?.7/3:0,duration:.7,ease:x.we},y:{delay:n&&u?.7/3:.7,duration:.7,ease:x.we}},children:l})})}),(0,a.jsxs)("div",{className:U().actions,children:[(0,a.jsx)(C(),{href:b,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(f.P.button,{className:U().placeholderButton__1,initial:{opacity:0},animate:n&&u?{opacity:1}:{opacity:0},transition:{opacity:{delay:n&&u?.7/4*3:0,duration:.7,ease:x.we},y:{delay:n&&u?.7/4*3:.7,duration:.7,ease:x.we}},children:"VIEW OPEN ROLES"})}),(0,a.jsx)(C(),{href:w,children:(0,a.jsx)(f.P.button,{className:U().placeholderButton__2,initial:{opacity:0},animate:n&&u?{opacity:1}:{opacity:0},transition:{opacity:{delay:n&&u?.7/4*3:0,duration:.7,ease:x.we},y:{delay:n&&u?.7/4*3:.7,duration:.7,ease:x.we}},children:"DISCOVER MORE"})})]}),(0,a.jsx)(f.P.div,{className:U().onboard,initial:{opacity:0},animate:n?{opacity:1}:{opacity:0},transition:{delay:.7*!!n,duration:.7,ease:x.we},children:(0,a.jsx)("span",{className:U().hint,children:"SELECT AN OFFICE"})})]})};var R=t(38255),z=t(73906),N=t.n(z);let A=e=>{let{name:n,index:t,ref:i,animate:o,active:r,onPointerDown:s}=e,l=(0,R.A)("(min-width: 1024px)");return(0,a.jsx)("div",{role:"button",className:[N().container,r&&o?N().active:N().inactive].join(" "),onPointerDown:s,"data-active":+r,ref:e=>{e&&(i.current[t]=e)},children:(0,a.jsxs)("div",{className:N().wrapper,children:[(0,a.jsx)(f.P.div,{initial:{"--icon":0,opacity:0},animate:o?{"--icon":1,opacity:1}:{"--icon":0,opacity:0},transition:{opacity:{duration:.7*!o,ease:x.we},"--icon":{delay:.7*!o,duration:.7,ease:x.we}},className:N().icon,children:(0,a.jsx)(p.default,{src:"/svg/icon-plus.svg",alt:"Netflix Map Plus",width:l?20:16,height:l?20:16})}),(0,a.jsx)("div",{className:N().content,children:(0,a.jsx)("div",{className:N().contentRow,children:(0,a.jsx)(f.P.div,{className:N().name,initial:{y:"50%",opacity:0},animate:o?{y:"0%",opacity:1}:{y:"50%",opacity:0},transition:{opacity:{duration:.7,ease:x.we},y:{delay:.7*!o,duration:.7,ease:x.we}},children:n})})})]})})};var V=t(38216),F=t(48070),T=t(94083),k=t(87548),B=t(94497),j=t(23264),O=t(26451);function H(e){return e.replace(/#define\sGLSLIFY\s./,"")}var G=t(16764);class W extends b.BKk{clone(){let e=super.clone();return e.uniforms=Object.assign(e.uniforms,this.globalUniforms),e}cloneWithUniforms(e){let n=super.clone();return n.uniforms=Object.assign(n.uniforms,this.globalUniforms),n.uniforms=Object.assign(n.uniforms,e),n}constructor(e={}){let n=e.globalUniforms;delete e.globalUniforms,super(e=(0,G.D9)({vertexShader:"varying vec2 vUv;\n\nvoid main()	{\n    vUv = uv;\n\n    vec4 transformedPosition = vec4( position, 1.0 );\n\n    vec4 mvPosition = modelViewMatrix * transformedPosition;\n\n    gl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"#include <default_pars>\n#include <default_frag_pars>\n\nvarying vec2 vUv;\n\nvoid main() {\n    gl_FragColor = vec4(vUv.xy, 1., 1.);\n\n    #include <colorspace_fragment>\n}",uniforms:{...eV.instance.globalUniforms}},e)),this.name=this.constructor.name,this.globalUniforms=n,this.uniforms=Object.assign(this.uniforms,this.globalUniforms)}}var Y=t(83957),q=t(35833),Q=t(53789),X=t(9548);let J=e=>{class n extends e{init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=(0,G.D9)({name:this.constructor.name},e),this.name=String(this.options.name),this.assets={models:{},textures:{}},this.load()}build(){}addEvents(){}removeEvents(){}destroy(){this.stop()}start(){this.enabled||(this.enabled=!0,this.addEvents())}stop(){this.enabled&&(this.enabled=!1,this.removeEvents())}update(){}resize(){}load(){}addGui(){this.WebGL.Gui&&this.WebGL.Gui.autoAddObject({object:this})}constructor(...e){super(...e),this.WebGL=eV.instance,this.enabled=!1}}return n};class Z extends W{constructor(e={}){super(e=(0,G.D9)({vertexShader:"varying vec2 vUv;\nvarying vec3 vNormal;\n\nvoid main()	{\n    vUv = uv;\n\n    vec4 transformedPosition = vec4( position, 1.0 );\n\n    vec3 objectNormal = vec3( normal );\n    vNormal = normalMatrix * objectNormal;\n\n    vec4 mvPosition = modelViewMatrix * transformedPosition;\n\n    gl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"#include <default_pars>\n#include <default_frag_pars>\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\n\nuniform vec3 uColor;\nuniform bool uDevCameraActive;\n\nvoid main() {\n    gl_FragColor = vec4(normalize(vNormal.xyz), 1.);\n\n    if (uDevCameraActive) {\n        gl_FragColor = vec4(uColor, 1.);\n    }\n\n    #include <colorspace_fragment>\n}\n",uniforms:{uColor:{value:new b.Q1f(0xffff00),gui:{tooltip:"Base colour. It won't do anything at the moment."}}}},e))}}class K extends J(b.eaF){update(){this.rotation.y+=.005}constructor(){super(new b.UPV(1,.4,132,16),new Z),this.init({name:"Dummy"})}}var $=t(35914),ee=t(89636);function en(e){return n=>t=>{if(!n&&void 0===t)return{succeeded:!1,value:void 0};if(n&&void 0===t)return{succeeded:!0,value:void 0};let i=e(t);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function et(e){return{custom:n=>en(n)(e),boolean:en(e=>"boolean"==typeof e?e:void 0)(e),number:en(e=>"number"==typeof e?e:void 0)(e),string:en(e=>"string"==typeof e?e:void 0)(e),function:en(e=>"function"==typeof e?e:void 0)(e),constant:n=>en(e=>e===n?n:void 0)(e),raw:en(e=>e)(e),object:n=>en(e=>{if(null!==e&&"object"==typeof e)return Object.keys(n).reduce((t,i)=>{if(void 0===t)return;let a=(0,n[i])(e[i]);return a.succeeded?Object.assign(Object.assign({},t),{[i]:a.value}):void 0},{})})(e),array:n=>en(e=>{if(Array.isArray(e))return e.reduce((e,t)=>{if(void 0===e)return;let i=n(t);if(i.succeeded&&void 0!==i.value)return[...e,i.value]},[])})(e)}}let ei={optional:et(!0),required:et(!1)};function ea(e,n,t,i){return new(t||(t=Promise))(function(a,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var n;e.done?a(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(r,s)}l((i=i.apply(e,n||[])).next())})}function eo(e){return ea(this,void 0,void 0,function*(){let n=new Image;return n.crossOrigin="anonymous",new Promise(t=>{n.src=e,n.decode().then(()=>{t(n)})})})}function er(e){return new Promise(n=>{n(e)})}let es=(e,n)=>"tp-imgv"+(e?"_".concat(e):"")+(n?"-".concat(n):"");class el{changeImage(e){this.image_.src=e}changeDraggingState(e){let n=this.element;e?null==n||n.classList.add(es("area_dragging")):null==n||n.classList.remove(es("area_dragging"))}constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(es()),n.viewProps.bindClassModifiers(this.element),this.input=e.createElement("input"),this.input.classList.add(es("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",n.extensions.join(",")),this.element.appendChild(this.input),this.image_=e.createElement("img"),this.image_.classList.add(es("image")),this.image_.classList.add(es("image_".concat(n.imageFit))),this.element.classList.add(es("area_root")),this.element.appendChild(this.image_)}}class ec{onFile(e){let n=(null==e?void 0:e.target).files;if(!n||!n.length)return;let t=n[0],i=URL.createObjectURL(t);this.setValue(i),this.updateImage(i)}onDrop(e){return ea(this,void 0,void 0,function*(){e.preventDefault();try{let{dataTransfer:n}=e,t=null==n?void 0:n.files[0];if(t){let e=URL.createObjectURL(t);this.updateImage(e),this.setValue(e)}else{let e=null==n?void 0:n.getData("url");if(!e)throw Error("No url");eo(e).then(e=>ea(this,void 0,void 0,function*(){let n=yield er(e);this.updateImage(n.src),this.setValue(n)}))}}catch(e){console.error("Could not parse the dropped image",e)}finally{this.view.changeDraggingState(!1)}})}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(e){return ea(this,void 0,void 0,function*(){if(e instanceof HTMLImageElement)er(e).then(e=>{this.updateImage(e.src)});else if("string"==typeof e){let n="";try{if("placeholder"===e)throw Error("placeholder");new URL(e),n=(yield eo(e)).src}catch(e){n=(yield this.handlePlaceholderImage()).src}finally{this.updateImage(n),this.setValue(n)}}})}updateImage(e){this.view.changeImage(e)}setValue(e){return ea(this,void 0,void 0,function*(){e instanceof HTMLImageElement?this.value.setRawValue(e):e?this.value.setRawValue((yield eo(e))):this.value.setRawValue((yield this.handlePlaceholderImage()))})}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return ea(this,void 0,void 0,function*(){return this.placeholderImage||(this.placeholderImage=yield function(){let e=document.createElement("canvas");e.width=128,e.height=64;let n=e.getContext("2d");return n.fillStyle="#222",n.fillRect(0,0,e.width,e.height),n.fillStyle="#ddd",n.font="monospaced",n.textAlign="center",n.textBaseline="middle",n.fillText("No image",.5*e.width,.5*e.height),new Promise(n=>{e.toBlob(e=>{let t=new Image;t.src=URL.createObjectURL(e),t.onload=()=>{n(t)}})})}()),this.placeholderImage})}exportState(){return{disabled:!1,hidden:!1}}importState(e){return!1}constructor(e,n){this.placeholderImage=null,this.value=n.value,this.viewProps=n.viewProps,this.viewProps.exportState=this.exportState,this.viewProps.importState=this.importState,this.view=new el(e,{viewProps:this.viewProps,extensions:n.extensions,imageFit:n.imageFit}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose(()=>{this.view.input.removeEventListener("change",this.onFile),this.view.input.removeEventListener("drop",this.onDrop),this.view.input.removeEventListener("dragover",this.onDragOver),this.view.input.removeEventListener("dragleave",this.onDragLeave)}),this.value.emitter.on("change",this.handleValueChange.bind(this)),this.handleValueChange()}}let eu=[".jpg",".png",".gif"],ed="input-image",eh=".tp-imgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-imgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-imgv:hover{background-color:var(--in-bg-h)}.tp-imgv:focus{background-color:var(--in-bg-f)}.tp-imgv:active{background-color:var(--in-bg-a)}.tp-imgv:disabled{opacity:0.5}:root{--tp-plugin-image-dragging-color: hsla(230, 100%, 66%, 1.00)}.tp-imgv{cursor:pointer;display:grid;height:calc(var(--cnt-usz) * 3);overflow:hidden;position:relative}.tp-imgv.tp-v-disabled{opacity:0.5}.tp-imgv_input{width:100%;height:100%;opacity:0}.tp-imgv_image{width:100%;height:100%;position:absolute;pointer-events:none;border:0}.tp-imgv_image_contain{-o-object-fit:contain;object-fit:contain}.tp-imgv_image_cover{-o-object-fit:cover;object-fit:cover}.tp-imgv_area_root{transition:opacity 0.16s ease-in-out}.tp-imgv_area_dragging{border:2px dashed var(--tp-plugin-image-dragging-color);border-radius:6px;opacity:0.6}",em={id:ed,type:"input",core:{major:2},accept(e,n){if(!(e instanceof HTMLImageElement||"string"==typeof e))return null;let t=function(e,n){let t=ei.required.object(n)(e);return t.succeeded?t.value:void 0}(n,{view:ei.required.constant("input-image"),acceptUrl:ei.optional.boolean,imageFit:ei.optional.custom(e=>"contain"===e||"cover"===e?e:void 0),extensions:ei.optional.array(ei.required.string)});return t?{initialValue:e,params:t}:null},binding:{reader:e=>e=>e instanceof HTMLImageElement?""===e.src?"placeholder":e.src:"string"==typeof e?e:"placeholder",writer:e=>(e,n)=>{e.write(n)}},controller(e){let n,t;return new ec(e.document,{value:e.value,imageFit:null!=(n=e.params.imageFit)?n:"cover",viewProps:e.viewProps,extensions:null!=(t=e.params.extensions)?t:eu})}},ev='<svg viewBox="0 0 32 32">\n<path fill="#c1c1c1" d="M 4 4 L 4 5 L 4 23 L 4 24 L 5 24 L 11 24 L 11 22 L 6 22 L 6 6 L 18 6 L 18 7 L 20 7 L 20 5 L 20 4 L 19 4 L 5 4 L 4 4 z M 12 8 L 12 9 L 12 27 L 12 28 L 13 28 L 27 28 L 28 28 L 28 27 L 28 9 L 28 8 L 27 8 L 13 8 L 12 8 z M 14 10 L 26 10 L 26 26 L 14 26 L 14 10 z"/>\n</svg>';class eg extends ee.Zv{addRendererStats(){if(!eV.instance)return;let e=this.addFolder({title:"Renderer Stats",expanded:!1});e.addBinding(eV.instance.renderer.info.render,"calls",{label:"draw calls",interval:500,readonly:!0}),e.addBinding(eV.instance.renderer.info.render,"triangles",{interval:500,readonly:!0}),e.addBinding(eV.instance.renderer.info.memory,"geometries",{interval:1e4,readonly:!0}),e.addBinding(eV.instance.renderer.info.memory,"textures",{interval:1e4,readonly:!0})}addImportExport(){let e,n=this.addFolder({title:"Import/Export",expanded:!0}),t=document.createElement("div");Object.assign(t.style,{display:"none",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh",position:"fixed",top:"0px",left:"0px",zIndex:"99999999",backdropFilter:"blur(10px)"}),t.addEventListener("click",e=>{e.target!==i&&(t.style.display="none")});let i=document.createElement("textarea");i.placeholder="Paste exported data here...",Object.assign(i.style,{width:"90%",height:"90%",maxWidth:"400px",maxHeight:"300px",background:"rgba(0, 0, 0, 0.8)",color:"white",fontFamily:"monospace",fontSize:"11px",marginBottom:"2rem"}),t.appendChild(i);let a=document.createElement("button");a.innerHTML="Apply",a.addEventListener("click",()=>{i.value&&(localStorage.setItem(window.location.href+".gui",i.value),this.importState(JSON.parse(i.value)),i.value="")}),t.appendChild(a),document.body.appendChild(t),n.addButton({title:"Import",export:!1}).on("click",()=>{t.style.display="flex",i.focus()});let o=n.addButton({title:"Export",export:!1}).on("click",()=>{o.disabled=!0,this.allowStateSaving=!1;let n=this.exportState();console.log(n);let a=JSON.stringify(n);localStorage.setItem(window.location.href+".gui",a),navigator.clipboard?navigator.clipboard.writeText(a):(t.style.display="flex",i.value=a,i.focus(),i.select(),document.execCommand("copy"),i.value="",t.style.display="none"),o.title="Copied!",clearTimeout(e),setTimeout(()=>{this.allowStateSaving=!0,o.title="Export",o.disabled=!1},2e3)});n.addButton({title:"Reset",export:!1}).on("click",()=>{this.importState(JSON.parse(this.originalData)),localStorage.setItem(window.location.href+".gui",this.originalData)}),setTimeout(()=>{if(this.originalData=JSON.stringify(this.exportState()),this.options.saveState){let e=localStorage.getItem(window.location.href+".gui");e&&this.importState(JSON.parse(e))}},200),setInterval(()=>{this.options.saveState&&this.allowStateSaving&&localStorage.setItem(window.location.href+".gui",JSON.stringify(this.exportState()))},1e3);let r=n.element.querySelector(".tp-fldv_c");r&&(r.style.display="flex",r.style.justifyContent="space-between",r.querySelectorAll(".tp-lblv").forEach(e=>{e.style.width="32%",e.style.margin="0"}))}importState(e){let n=(e,t)=>{if(!t||e.title&&t.title&&e.title!==t.title||e.children&&t.children&&Array.isArray(e.children)&&Array.isArray(t.children)&&e.children.length!==t.children.length||e.label&&t.label&&e.label!==t.label)return!1;if(e.children&&t.children&&Array.isArray(e.children)&&Array.isArray(t.children)&&e.children.length&&t.children.length){for(let i=0;i<e.children.length;i++)if(!n(e.children[i],t.children[i]))return!1}return!0},t=JSON.parse(this.originalData),i=!1;Array.isArray(e.children)&&t.children.length!==e.children.length&&(i=!0);for(let a=0;a<t.children.length;a++)if(Array.isArray(e.children)&&!n(t.children[a],e.children[a])){i=!0;break}return i?(console.error("Error when attempting to import GUI state: state structure does not match, resetting to original data instead"),super.importState(t)):super.importState(e)}addFolder(e){let n=super.addFolder(e);n.addFolder=this.addFolder,n.addButton=this.addButton;let t=document.createElement("button");return t.classList.add("tp-btnv_b"),Object.assign(t.style,{position:"absolute",right:"26px",top:"2px",backgroundColor:"#232323",color:"#c1c1c1",fontWeight:"400",fontSize:"14px",height:"var(--cnt-usz)",width:"var(--cnt-usz)",display:"flex",justifyContent:"center",alignItems:"center",padding:"2px"}),t.innerHTML=ev,t.setAttribute("title","Copy Data to Clipboard"),n.element.appendChild(t),t.addEventListener("click",()=>{let e=n.exportState(),i=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(e.children)){var t;null==(t=e.children)||t.forEach(e=>{e.children?(n[e.title]={},i(e,n[e.title])):e.binding?n[e.label]=e.binding.value:e.options&&(n[e.label]=e.options[e.value].text)})}},a={};i(e,a);let o=JSON.stringify(a,void 0,2);if(navigator.clipboard)navigator.clipboard.writeText(o);else{let e=document.createElement("textarea");document.body.appendChild(e),e.value=o,e.focus(),e.select(),document.execCommand("copy"),e.value="",document.body.removeChild(e),e=null}t.innerHTML="âœ”",setTimeout(()=>{t.innerHTML=ev},2e3)}),n}addButton(e){let n=super.addButton(e);if(!1===e.export){let e=n.controller.exportState.bind(n.controller);n.controller.exportState=()=>Object.assign(e(),{disabled:!1,hidden:!1})}return n}refresh(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.options.syncGuiValues&&(this.fireChange=e,super.refresh(),this.fireChange=!0)}autoAddObject(e){let{object:n,folder:t,exclude:i=[],include:a=[],addDefines:o=!0,expanded:r=!1}=e,s={};if(!t&&"type"in n&&(s.folder=t=this.addFolder({title:"name"in n?"".concat(n.type,": ").concat(n.name):String(n.type),expanded:r})),n instanceof b.B69&&t&&(s.transformsFolder=this.autoAddTransforms({folder:t,object:n})),t&&n instanceof b.eaF&&n.material instanceof b.imn){let e=t.addFolder({title:"material",expanded:!0});this.autoAddMaterial({folder:e,material:n.material,exclude:i,include:a,addDefines:o}),s.materialFolder=e}return s}autoAddTransforms(e){let{folder:n,object:t}=e;n.addBinding(t,"visible",{index:0});let i={rotation:{x:t.rotation.x,y:t.rotation.y,z:t.rotation.z}},a=n.addFolder({title:"transforms",expanded:!0});return a.addBinding(t,"position"),a.addBinding(i,"rotation").on("change",()=>{t.rotation.set(i.rotation.x,i.rotation.y,i.rotation.z)}),a.addBinding(t,"scale"),a}autoAddMaterial(e){let{folder:n,material:t,options:i=!0,exclude:a,include:o,addDefines:r=!0}=e;if(i){let e=n.addFolder({title:"options",expanded:!1});"wireframe"in t&&e.addBinding(t,"wireframe"),e.addBinding(t,"side",{view:"list",label:"side",value:t.side,options:{front:b.hB5,back:b.hsX,double:b.$EB}}).on("change",e=>{t.side=e.value,console.log("change")}),e.addBinding(t,"blending",{view:"list",label:"blending",value:t.blending,options:{NoBlending:b.XIg,NormalBlending:b.NTi,AdditiveBlending:b.EZo,SubtractiveBlending:b.Kwu,MultiplyBlending:b.EdD,CustomBlending:b.bCz}}).on("change",e=>{t.blending=e.value}),e.addBinding(t,"transparent"),e.addBinding(t,"depthTest"),e.addBinding(t,"depthWrite"),e.addBinding(t,"colorWrite")}if("uniforms"in t&&this.autoAddUniforms(n,t.uniforms,a,o),r){for(let e in t.defines)if(!("FOG_PMREM"===e||e.toLowerCase().includes("cubeuv")||a&&a.includes(e))&&(!o||!o.length||o.includes(e)))if(e.toLowerCase().includes("tonemap")){let e={LinearToneMapping:0,ReinhardToneMapping:1,OptimizedCineonToneMapping:2,ACESFilmicToneMapping:3};if("uniforms"in t){n.addBinding(t.defines,"USE_TONEMAPPING").on("change",e=>{t.needsUpdate=!0,i.disabled=!e.value,a.disabled=!e.value});let i=n.addBinding(t.uniforms.uToneMapping,"value",{label:"uToneMapping",options:e,disabled:!t.defines.USE_TONEMAPPING}),a=n.addBinding(t.uniforms.toneMappingExposure,"value",{label:"toneMappingExposure",min:0,max:5,step:.001,disabled:!t.defines.USE_TONEMAPPING})}}else n.addBinding(t.defines,e).on("change",()=>{t.needsUpdate=!0})}let s=["color","bumpMap","bumpScale","displacementBias","displacementMap","displacementScale","emissive","emissiveIntensity","emissiveMap","ior","map","metalness","metalnessMap","normalMap","normalScale","opacity","reflectivity","roughness","roughnessMap","specular","specularColor","specularMap","specularIntensity","specularColorMap","specularIntensityMap","thickness","_transmission"];if("ShaderMaterial"!==t.type&&"RawShaderMaterial"!==t.type)for(let e in t){let i=e;if(s.includes(i)&&i in t)if(null===t[i]){if(i.toLowerCase().includes("map")){let e={tex:new b.gPd};this.addImage(n,e,"tex",i,{},()=>{"isMaterial"!==i&&(t[i]=e.tex),t.needsUpdate=!0}),n.addBinding(e.tex,"repeat",{label:i+" repeat",step:.01}).on("change",()=>{"object"==typeof t[i]&&t[i]&&"needsUpdate"in t[i]&&(t[i].needsUpdate=!0)})}}else if(t[i]instanceof b.Q1f)this.addColor(n,t,i,i,!1);else if(t[i]instanceof b.gPd){if(t[i]instanceof b.GYF)continue;this.addImage(n,t,i,i),n.addBinding(t[i],"repeat",{label:i+" repeat",step:.01}).on("change",()=>{"object"==typeof t[i]&&t[i]&&"needsUpdate"in t[i]&&(t[i].needsUpdate=!0)})}else if(i.includes("_")){let e=i.replace("_","");n.addBinding(t,i).on("change",n=>{"isMaterial"!==e&&(t[e]=n.value),t.needsUpdate=!0})}else n.addBinding(t,i,{step:.01})}}autoAddUniforms(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"FOG";for(let o in n){if("uTime"===o||"uResolution"===o||"uDevCameraActive"===o||o.toLowerCase().includes("delta")||t.includes(o)||i.length&&!i.includes(o)||o.toLowerCase().includes("tonemap")||a&&o.toUpperCase().includes(a))continue;let r=n[o];if(null===r.value||void 0===r.value){console.error("Error when attempting to auto-add uniform: "+o+" has no value");continue}r.value.isMatrix4||r.value.isRenderTargetTexture||r.value.isDepthTexture||r.value instanceof b.GYF||r.value instanceof Array||(r.value.isColor?this.addColor(e,r,"value",o):r.value.isTexture?this.addImage(e,r,"value",o):e.addBinding(r,"value",{label:o,...r.gui}))}}addColor(e,n,t,i){let a=!(arguments.length>4)||void 0===arguments[4]||arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r="";if(a)this.setupColorUniform(n);else{let e=n["".concat(t)];e instanceof b.Q1f&&(n["guiValue"+(r=i)]="#"+e.getHexString())}return e.addBinding(n,"guiValue"+r,{label:i,picker:"inline"}).on("change",()=>{if(this.fireChange&&(n[t]instanceof b.Q1f&&n[t].set(n["guiValue"+r]),o&&o.length>0))for(let e of o)e[t]instanceof b.Q1f&&e[t].set(n["guiValue"+r])})}setupColorUniform(e){e.value instanceof b.Q1f||!e.value||(e.value=new b.Q1f().set(e.value.r,e.value.g,e.value.b)),e.value instanceof b.Q1f&&(e.guiValue="#"+e.value.getHexString())}addImage(e,n,t,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5?arguments[5]:void 0;n[t].firstLoad=!0,n[t].image||(n[t].image=new Image),a=Object.assign({minFilter:n[t].minFilter,magFilter:n[t].magFilter,wrapping:n[t].wrapS,flipY:n[t].flipY,colorSpace:n[t].colorSpace},a);let r=e.addBinding(n[t],"image",{label:i,view:"input-image"}).on("change",e=>{if(null!==e.value){if(n[t].firstLoad){n[t].firstLoad=!1;return}n[t]=eV.instance.generateTexture(e.value,a),n[t].needsUpdate=!0,o&&o(n[t])}});return r.controller.value.binding.read=()=>{},r}setTheme(){this.containerElement.style.width="350px",this.containerElement.style.position="fixed",this.containerElement.style.maxHeight="98vh",this.containerElement.style.overflowY="auto",this.containerElement.style.zIndex="9999999",this.containerElement.style.backdropFilter="blur(10px)",this.containerElement.firstChild&&this.containerElement.firstChild instanceof HTMLElement&&(this.containerElement.firstChild.style.overflow="hidden");let e=document.createElement("style");e.innerHTML="\n			:root {\n				--tp-base-background-color: hsla(0, 0%, 10%, 0.80);\n				--tp-base-shadow-color: hsla(0, 0%, 0%, 0.2);\n				--tp-button-background-color: hsla(0, 0%, 80%, 1.00);\n				--tp-button-background-color-active: hsla(0, 0%, 100%, 1.00);\n				--tp-button-background-color-focus: hsla(0, 0%, 95%, 1.00);\n				--tp-button-background-color-hover: hsla(0, 0%, 85%, 1.00);\n				--tp-button-foreground-color: hsla(0, 0%, 0%, 0.80);\n				--tp-container-background-color: hsla(0, 0%, 0%, 0.30);\n				--tp-container-background-color-active: hsla(0, 0%, 0%, 0.60);\n				--tp-container-background-color-focus: hsla(0, 0%, 0%, 0.50);\n				--tp-container-background-color-hover: hsla(0, 0%, 0%, 0.40);\n				--tp-container-foreground-color: hsla(0, 0%, 100%, 0.50);\n				--tp-groove-foreground-color: hsla(0, 0%, 0%, 0.20);\n				--tp-input-background-color: hsla(0, 0%, 0%, 0.30);\n				--tp-input-background-color-active: hsla(0, 0%, 0%, 0.60);\n				--tp-input-background-color-focus: hsla(0, 0%, 0%, 0.50);\n				--tp-input-background-color-hover: hsla(0, 0%, 0%, 0.40);\n				--tp-input-foreground-color: hsla(0, 0%, 100%, 0.50);\n				--tp-label-foreground-color: hsla(0, 0%, 100%, 0.50);\n				--tp-monitor-background-color: hsla(0, 0%, 0%, 0.30);\n				--tp-monitor-foreground-color: hsla(0, 0%, 100%, 0.30);\n			}\n\n			.tp-dfwv::-webkit-scrollbar {\n				display: none;\n			}\n			",document.head.appendChild(e)}enableDrag(e){let n=0,t=0,i=0,a=0,o=this.containerElement.querySelector("button.tp-rotv_b");function r(e,n,t){return Math.max(n,Math.min(t,e))}function s(s){(s=s||window.event).preventDefault(),n=i-s.clientX,t=a-s.clientY,i=s.clientX,a=s.clientY,e.style.top=r(e.offsetTop-t,0,eV.Viewport.h-100)+"px",e.style.left=r(e.offsetLeft-n,0,eV.Viewport.w-100)+"px",o&&(o.style.pointerEvents="none")}function l(){document.onmouseup=null,document.onmousemove=null,o&&(o.style.pointerEvents="auto")}o&&(o.onmousedown=function(e){(e=e||window.event).preventDefault(),i=e.clientX,a=e.clientY,document.onmouseup=l,document.onmousemove=s})}get containerElement(){return this.containerElem_}constructor(){super({title:"Options"}),this.fireChange=!0,this.allowStateSaving=!1,this.originalData="",this.originalSyncGuiOption=!0,this.options={syncGuiValues:!0,saveState:!0},this.setTheme(),this.containerElement.addEventListener("wheel",e=>{e.stopPropagation()});let e=this.containerElement.querySelector("button.tp-rotv_b");e&&(e.style.cursor="move"),this.enableDrag(this.containerElement),this.registerPlugin($),this.registerPlugin(i);let n=localStorage.getItem(window.location.href+".guiSaveState");null!==n&&(this.options.saveState="true"===n),this.originalSyncGuiOption=this.options.syncGuiValues,this.addImportExport(),this.settingsFolder=this.addFolder({title:"Gui Settings",expanded:!1}),this.settingsFolder.addBinding(this.options,"syncGuiValues"),localStorage.setItem(window.location.href+".guiSaveState",String(this.options.saveState)),this.settingsFolder.addBinding(this.options,"saveState").on("change",e=>{localStorage.setItem(window.location.href+".guiSaveState",String(e.value)),!1===e.value&&localStorage.removeItem(window.location.href+".gui")}),setTimeout(()=>{document.querySelectorAll(".tp-svpv_c").forEach(e=>{e.addEventListener("mousedown",()=>{this.options.syncGuiValues=!1})}),document.addEventListener("mouseup",()=>{this.options.syncGuiValues=this.originalSyncGuiOption})},1),this.addRendererStats()}}class ef extends eg{addCamera(){let e=this.addFolder({title:"Camera",expanded:!1});e.addBinding(this.scene.controls,"enabled",{label:"orbit camera"}).on("change",e=>{eV.instance.renderer.domElement.style.zIndex=e.value?"0":"-1",eV.instance.globalUniforms.uDevCameraActive.value=e.value}),e.addBinding(this.scene.cameraHelper,"visible",{label:"camera helper"}),e.addBinding(this.scene.devCamera,"position",{label:"orbit position"}),e.addBinding(this.scene.controls,"target",{label:"orbit target"}),e.addBinding(this.scene.options,"cameraXTranslate"),e.addBinding(this.scene.options,"cameraYTranslate"),e.addBinding(this.scene.options,"cameraZTranslate")}constructor(e){super(),this.scene=eV.instance.scenes[e],this.addCamera()}}class ep extends b.Z58{init(){}build(){for(let a in this.buildCameras(),this.buildDebugEnvironment(),this.buildPasses(),this.WebGL.options.urlParams.has("gui")&&this.name===this.WebGL.sceneName&&(this.WebGL.Gui=new ef(this.name||"BaseScene")),0===Object.keys(this.components).length&&(this.components.dummy=new K),this.components){var e,n,t,i;this.components[a].scene=this,this.components[a]instanceof b.B69&&this.add(this.components[a]),null==(e=(n=this.components[a]).build)||e.call(n),this.WebGL.options.urlParams.has("gui")&&this.name===this.WebGL.sceneName&&(null==(t=(i=this.components[a]).addGui)||t.call(i))}}buildCameras(){for(let e in this.camera=new b.ubm(45,eV.Viewport.w/eV.Viewport.h,.1,500),this.camera.setFocalLength(Number(this.options.cameraFocalLength)),this.cameraPosition=new b.Pq0(0,0,20),this.cameraLookAt=new b.Pq0(0,0,0),this.camera.position.copy(this.cameraPosition),this.camera.lookAt(this.cameraLookAt),this.cameraHelper=new b.WTh(this.camera),this.cameraHelper.visible=!1,this.add(this.cameraHelper),this.devCamera=new b.ubm(45,eV.Viewport.w/eV.Viewport.h,.1,1e4),this.devCamera.position.z=20,this.devCamera.position.y=3,this.controls=new q.N(this.devCamera,this.WebGL.renderer.domElement),this.controls.target.set(0,0,0),this.controls.enabled=!!this.options.controls,this.controls.zoomToCursor=!0,this.activeCamera=this.camera,this.controls.enabled&&(this.WebGL.renderer.domElement.style.zIndex="0",this.WebGL.globalUniforms.uDevCameraActive.value=!0),this.cameraLayers)this.camera.layers.enable(this.cameraLayers[e]),this.devCamera.layers.enable(this.cameraLayers[e])}buildDebugEnvironment(){let e=new b.fTw(200,50);e.position.y=-10,e.material.opacity=.5,e.material.transparent=!0,this.add(e)}buildPasses(){this.renderPass=new Q.A(this,this.activeCamera),this.renderPass.enabled=!1,this.savePass=new X.V,this.savePass.enabled=!1,this.WebGL.composerPasses.add(this.renderPass,0),this.WebGL.composerPasses.add(this.savePass,1)}updateCameras(){this.camera.position.copy(this.cameraPosition),this.camera.lookAt(this.cameraLookAt),this.camera.translateX(Number(this.options.cameraXTranslate)),this.camera.translateY(Number(this.options.cameraYTranslate)),this.camera.translateZ(Number(this.options.cameraZTranslate)),this.updateCameraFocalLength(),this.camera.updateProjectionMatrix()}updateCameraFocalLength(){this.camera.getFocalLength()!==this.options.cameraFocalLength&&this.camera.setFocalLength(Number(this.options.cameraFocalLength))}update(){for(let t in this.components){var e,n;null==(e=(n=this.components[t]).update)||e.call(n)}}addEvents(){Y.Gt.update(this.onRaf,!0),window.addEventListener("resize",this.onResize)}removeEvents(){(0,Y.WG)(this.onRaf),window.removeEventListener("resize",this.onResize)}start(){if(!this.enabled)for(let t in this.enabled=!0,this.WebGL.activeScene=this,this.renderPass.enabled=!0,this.addEvents(),this.components){var e,n;null==(e=(n=this.components[t]).start)||e.call(n)}}stop(){if(this.enabled)for(let t in this.enabled=!1,this.renderPass.enabled=!1,this.removeEvents(),this.components){var e,n;null==(e=(n=this.components[t]).stop)||e.call(n)}}constructor(e,n={}){super(),this.WebGL=eV.instance,this.enabled=!1,this.cameraLayers={all:0},this.options={controls:eV.instance.options.urlParams.has("controls"),cameraFocalLength:50,cameraXTranslate:0,cameraYTranslate:0,cameraZTranslate:0,cameraPivotStrength:0,cameraPivotOffset:20,cameraPivotAngle:new b.I9Y(.05,.05),cameraPivotRollAmount:.2,pointerLerpSpeed1:.032,pointerLerpSpeed2:.025,passes:[]},this.originalOptions={},this.components={},this.globalUniforms={},this.globalDefines={},this.onRaf=()=>{var e,n;(null==(e=this.controls)?void 0:e.enabled)&&this.controls.update(),this.updateCameras(),this.update(),(null==(n=this.controls)?void 0:n.enabled)&&(this.cameraHelper.visible&&this.cameraHelper.update(),this.WebGL.renderer.render(this,this.devCamera))},this.onResize=()=>{for(let t in this.camera.aspect=eV.Viewport.w/eV.Viewport.h,this.camera.updateProjectionMatrix(),this.devCamera.aspect=eV.Viewport.w/eV.Viewport.h,this.devCamera.updateProjectionMatrix(),this.updateCameraFocalLength(),this.components){var e,n;null==(e=(n=this.components[t]).resize)||e.call(n)}},this.name=e,this.name=e,this.prettyName=e.charAt(0).toUpperCase()+e.slice(1).replace("-",""),this.options=(0,G.D9)(this.options,n),this.originalOptions={...this.options},this.background=new b.Q1f(2236962),this.init()}}let eb=ep;var ex=t(2915);let ey=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|FBAN|FBAV|fennec|hiptop|iemobile|ip(hone|od)|Instagram|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,ew=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;function e_(){if("undefined"==typeof navigator)return!1;let e=navigator.userAgent.toLowerCase();return ey.test(e)||ew.test(e.substr(0,4))}let eL=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|FBAN|FBAV|fennec|hiptop|iemobile|ip(hone|od)|Instagram|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,eS=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;function eP(){if("undefined"==typeof navigator)return!1;let e=navigator.userAgent.toLowerCase();return eL.test(e)||eS.test(e.substr(0,4))||navigator.maxTouchPoints>2}class eD extends W{constructor(e={}){super(e=(0,G.D9)({vertexShader:"varying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWorldNormal;\nvarying vec3 vViewPosition;\n\nvoid main()	{\n    vUv = uv;\n    vPosition = position;\n\n    vec4 transformedPosition = vec4( position, 1.0 );\n\n    vec3 objectNormal = vec3( normal );\n    vNormal = normalMatrix * objectNormal;\n\n    vec4 mvPosition = modelViewMatrix * transformedPosition;\n    vViewPosition = - mvPosition.xyz;\n\n    gl_Position = projectionMatrix * mvPosition;\n}\n",fragmentShader:"#include <default_pars>\n#include <default_frag_pars>\n#include <circle_pars>\n#include <cnoise_pars>\n#include <packing>\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\nvarying vec3 vPosition;\nvarying vec3 vWorldNormal;\n\n#include <tonemapping_pars_fragment>\nuniform int uToneMapping;\n\nuniform vec2 uResolution;\nuniform vec3 uColorLeftGradient1;\nuniform vec3 uColorLeftGradient2;\nuniform vec3 uColorRightGradient1;\nuniform vec3 uColorRightGradient2;\nuniform vec3 uColorHighLight1;\nuniform vec3 uColorHighLight2;\nuniform float uTime;\nuniform float uBackOpacity;\n\nuniform vec3 uLightLeftPos;\nuniform vec3 uLightLeftParams;\n\nuniform vec4 uHighLightLeft1;\nuniform vec4 uHighLightLeft2;\nuniform float uHighLightLeftStrength;\n\nuniform vec3 uLightRightPos;\nuniform vec3 uLightRightParams;\n\nuniform vec4 uHighLightRight1;\nuniform vec4 uHighLightRight2;\nuniform float uHighLightRightStrength;\n\nuniform float uStreaksSpeed;\nuniform float uStreaksScale;\n\nuniform float uNoiseScale;\n\nuniform float uOpacity;\n\nfloat nsin(float x) { return sin(x) * 0.5 + 0.5; }\n\nvec2 getRatio(vec2 res) {\n    return vec2(\n        (res.x / res.y),\n        (res.y / res.x)\n    );\n}\n\nvec2 getHalfPixel(vec2 res) {\n    return vec2(\n        .5 / (res.x * 2.),\n        .5 / (res.y * 2.)\n    );\n}\n\nvec4 getMask(vec2 st, vec2 res, float radius, float fade, float smax) {\n    vec2 _st = st;\n    _st *= getRatio(res);\n    _st += getHalfPixel(res);\n\n    float c = circle(_st, 1., radius, fade);\n\n    float mask = length(_st);\n    mask = smoothstep(0.0, smax, c);\n\n    return vec4(\n        _st,\n        mask,\n        c\n    );\n}\nvec3 getHighLight(vec2 st, vec2 res, float radius, float fade, vec3 color) {\n    vec2 _st = st;\n    _st += getHalfPixel(res);\n\n    return mix(vec3(0.), color, circle(_st, 1., radius, fade));\n}\n\nvoid main() {\n    vec3 back = mix(uColorLeftGradient1, uColorRightGradient1, vUv.x) * uBackOpacity;\n    back *= (1. - distance(vUv.x, 0.5));\n    vec3 final = vec3(0.);\n\n    // LEFT\n    vec4 maskLeft = getMask(vec2(vUv.x + uLightLeftPos.x, vUv.y + uLightLeftPos.y), uResolution, uLightLeftParams.x, uLightLeftParams.y, uLightLeftParams.z);\n    vec3 gradientLeft = mix(uColorLeftGradient1, uColorLeftGradient2, smoothstep(0., 1., length(vec2(maskLeft.x + .2, maskLeft.y - .5))));\n    final = mix(final, gradientLeft, maskLeft.z);\n    // HIGH 1\n    final = final + blendOverlay(final, getHighLight(vec2(vUv.x + uHighLightLeft1.x, vUv.y + uHighLightLeft1.y), uResolution, uHighLightLeft1.z, uHighLightLeft1.w, uColorHighLight1 * uHighLightLeftStrength));\n    // HIGH 2\n    final = final + blendOverlay(final, getHighLight(vec2(vUv.x + uHighLightLeft2.x, vUv.y + uHighLightLeft2.y), uResolution, uHighLightLeft2.z, uHighLightLeft2.w, uColorHighLight1 * uHighLightLeftStrength));\n    // LEFT\n\n    // RIGHT\n    vec4 maskRight = getMask(vec2(vUv.x + uLightRightPos.x, vUv.y + uLightRightPos.y), uResolution, uLightRightParams.x, uLightRightParams.y, uLightRightParams.z);\n    vec3 gradientRight = mix(uColorRightGradient1, uColorRightGradient2, smoothstep(0., 1., length(vec2(maskRight.x + .2, maskRight.y - .5))));\n    final = mix(final, gradientRight, maskRight.z);\n    // HIGH 1\n    final = final + blendOverlay(final, getHighLight(vec2(vUv.x + uHighLightRight1.x, vUv.y + uHighLightRight1.y), uResolution, uHighLightRight1.z, uHighLightRight1.w, uColorHighLight2 * uHighLightRightStrength));\n    // HIGH 2\n    final = final + blendOverlay(final, getHighLight(vec2(vUv.x + uHighLightRight2.x, vUv.y + uHighLightRight2.y), uResolution, uHighLightRight2.z, uHighLightRight2.w, uColorHighLight2 * uHighLightRightStrength));\n    // RIGHT\n\n    vec3 colors = final;\n\n    // AURORA\n    vec2 uv = vUv;\n    float base = nsin(-(uTime * .001) + distance(uv.x, 0.5) * 50.0) * 1. + nsin((uTime * .001) + uv.x * distance(uv.x, 0.5) * 100.0) * 0.1 - 0.5;\n    base = 1.0 - smoothstep(uv.y - 4.0, uv.y * 1.0, base);\n    base += map(cnoise( vec3( uv * uNoiseScale, sin(uTime * .0005) ) ), -1.0, 1., 0., 1.0);\n\n    float aurora = nsin((distance(uv.x, 0.5)) * 25.0 * uStreaksScale + uTime * uStreaksSpeed) * nsin((distance(uv.x, 0.5)) * 18.0 * uStreaksScale + 2332.);\n    aurora = map(aurora, -0.8, 1.0, 0.3, 1.0);\n    aurora *= base;\n\n    gl_FragColor = vec4(vec3(back + (final) * aurora) * uOpacity, 1.);\n\n    #include <tonemapping_frag>\n    #include <colorspace_fragment>\n}\n\n",uniforms:{uOpacity:{value:1},uBackOpacity:{value:.015},uColorLeftGradient1:{value:new b.Q1f("#5d00f8")},uColorLeftGradient2:{value:new b.Q1f("#41016c")},uColorRightGradient1:{value:new b.Q1f("#9c01d2")},uColorRightGradient2:{value:new b.Q1f("#6a006c")},uColorHighLight1:{value:new b.Q1f("#fbf6fe")},uColorHighLight2:{value:new b.Q1f("#fbf6fe")},uLightLeftPos:{value:new ex.I(0,-.45)},uLightLeftParams:{value:new b.Pq0(1,2,3)},uHighLightLeft1:{value:new b.IUQ(-.07,.22500000000000003,1/3*2,5)},uHighLightLeft2:{value:new b.IUQ(-.1,-.225,1/6,5)},uHighLightLeftStrength:{value:1.65},uLightRightPos:{value:new ex.I(-1,-.55)},uLightRightParams:{value:new b.Pq0(1,19.3,3)},uHighLightRight1:{value:new b.IUQ(-1.1,-1.065,1/3*2,5)},uHighLightRight2:{value:new b.IUQ(-1.15,-.845,1/6,5)},uHighLightRightStrength:{value:2.92},uStreaksScale:{value:2.92*!e_()},uNoiseScale:{value:2.92},uStreaksSpeed:{value:-.0025}},transparent:!1,depthTest:!1,depthWrite:!1},e))}}let eC=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:window.innerWidth,y:window.innerHeight},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:window.innerWidth,y:window.innerHeight},i=eI(e);return{x:n.x/t.x*i.x,y:n.y/t.y*i.y}},eE=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:1,y:1},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:window.innerWidth,y:window.innerHeight},a=eI(e);return{x:n.x/2-a.x/2+t.x/i.x*a.x,y:-(n.y/2)+a.y/2-t.y/i.y*a.y}},eI=e=>{let n=2*Math.tan(e.fov*(Math.PI/180)/2)*e.position.z;return{x:n*e.aspect,y:n}};class eU extends J(b.eaF){addEvents(){window.addEventListener("resize",this.onResize)}removeEvents(){window.removeEventListener("resize",this.onResize)}show(){this.status||(this.status=!0,this.checkTween(),this.tween=(0,g.i)(this.material.uniforms.uOpacity,{value:1},{duration:1,ease:x.SD}))}hide(){this.status&&(this.status=!1,this.checkTween(),this.tween=(0,g.i)(this.material.uniforms.uOpacity,{value:0},{duration:1,ease:x.SD}))}setOpacity(e){this.material.uniforms.uOpacity.value=e}getOpacity(){return this.material.uniforms.uOpacity.value}checkTween(){this.tween&&this.tween.cancel()}build(){this.setSize()}setSize(){let e=eC(this.scene.activeCamera);this.scale.x=e.x,this.scale.y=e.y}constructor(){super(new b.bdM,new eD),this.status=!0,this.onResize=()=>{this.setSize()},this.init({name:"Background"})}}class eM extends eb{init(){this.background=new b.Q1f("#000000"),this.components={background:new eU,globe:new eY}}buildDebugEnvironment(){}}class eR{add(e,n){this.array.push({index:n,item:e}),this.array.sort(this.sort),this.updateSourceArray()}remove(e){for(let n=0;n<this.array.length;n++)this.array[n].item===e&&this.array.splice(n,1);this.updateSourceArray()}updateSourceArray(){this.sourceArray.length=0;for(let e=0;e<this.array.length;e++)this.sourceArray[e]=this.array[e].item}sort(e,n){return e.index>n.index?1:-1}constructor(e){this.array=[],this.sourceArray=e}}function ez(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return Math.min(window.devicePixelRatio,e)}function eN(){return"ontouchstart"in window||navigator.maxTouchPoints>0}class eA{init(){for(let e in this.sceneName||(this.sceneName=Object.keys(this.scenes)[0]),this.factory)this.scenes[e]=new this.factory[e](e,{})}buildPasses(){if(this.bloomPass=new O.C(new b.I9Y(eA.Viewport.w,eA.Viewport.h),.402,.696,0),this.bloomPass.enabled=!0,this.fxaaPass=new j.p(new W({vertexShader:"varying vec2 vUv;\n\nvarying vec2 vUvDown;\nvarying vec2 vUvUp;\nvarying vec2 vUvLeft;\nvarying vec2 vUvRight;\n\nvarying vec2 vUvDownLeft;\nvarying vec2 vUvUpRight;\nvarying vec2 vUvUpLeft;\nvarying vec2 vUvDownRight;\n\nuniform vec2 uResolution;\n\nvoid main() {\n\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    vec2 texelSize = vec2(1.0 / uResolution.x, 1.0 / uResolution.y);\n\n    vUvDown = uv + vec2(0.0, -1.0) * texelSize;\n	vUvUp = uv + vec2(0.0, 1.0) * texelSize;\n	vUvRight = uv + vec2(1.0, 0.0) * texelSize;\n	vUvLeft = uv + vec2(-1.0, 0.0) * texelSize;\n\n	vUvDownLeft = uv + vec2(-1.0, -1.0) * texelSize;\n	vUvUpRight = uv + vec2(1.0, 1.0) * texelSize;\n	vUvUpLeft = uv + vec2(-1.0, 1.0) * texelSize;\n	vUvDownRight = uv + vec2(1.0, -1.0) * texelSize;\n\n}",fragmentShader:"#include <common>\n\nprecision highp float;\n\n#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))\n#define ONE_OVER_TWELVE 0.08333333333333333\n\nvarying vec2 vUvDown;\nvarying vec2 vUvUp;\nvarying vec2 vUvLeft;\nvarying vec2 vUvRight;\n\nvarying vec2 vUvDownLeft;\nvarying vec2 vUvUpRight;\nvarying vec2 vUvUpLeft;\nvarying vec2 vUvDownRight;\n\nuniform sampler2D tDiffuse;\nuniform int uSamples;\n\nuniform vec2 uResolution;\n\nvarying vec2 vUv;\n\nvec4 fxaa(const in sampler2D inputBuffer, const in vec2 uv) {\n\n    vec2 texelSize = vec2(1.0 / uResolution.x, 1.0 / uResolution.y);\n\n    vec4 inputColor = texture2D(inputBuffer, uv);\n\n	// Luma at the current fragment.\n	float lumaCenter = luminance(inputColor.rgb);\n\n	// Luma at the four direct neighbours of the current fragment.\n	float lumaDown = luminance(texture2D(inputBuffer, vUvDown).rgb);\n	float lumaUp = luminance(texture2D(inputBuffer, vUvUp).rgb);\n	float lumaLeft = luminance(texture2D(inputBuffer, vUvLeft).rgb);\n	float lumaRight = luminance(texture2D(inputBuffer, vUvRight).rgb);\n\n	// Find the maximum and minimum luma around the current fragment.\n	float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));\n	float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));\n\n	// Compute the delta.\n	float lumaRange = lumaMax - lumaMin;\n\n	// Skip AA if the luma variation is lower than a threshold (low contrast or dark area).\n	if(lumaRange < max(EDGE_THRESHOLD_MIN, lumaMax * EDGE_THRESHOLD_MAX)) {\n\n		return inputColor;\n\n	}\n\n	// Query the 4 remaining corners lumas.\n	float lumaDownLeft = luminance(texture2D(inputBuffer, vUvDownLeft).rgb);\n	float lumaUpRight = luminance(texture2D(inputBuffer, vUvUpRight).rgb);\n	float lumaUpLeft = luminance(texture2D(inputBuffer, vUvUpLeft).rgb);\n	float lumaDownRight = luminance(texture2D(inputBuffer, vUvDownRight).rgb);\n\n	// Combine the four edges lumas (using intermediary variables for future computations with the same values).\n	float lumaDownUp = lumaDown + lumaUp;\n	float lumaLeftRight = lumaLeft + lumaRight;\n\n	// Same for corners.\n	float lumaLeftCorners = lumaDownLeft + lumaUpLeft;\n	float lumaDownCorners = lumaDownLeft + lumaDownRight;\n	float lumaRightCorners = lumaDownRight + lumaUpRight;\n	float lumaUpCorners = lumaUpRight + lumaUpLeft;\n\n	// Compute an estimation of the gradient along the horizontal and vertical axis.\n	float edgeHorizontal = (\n		abs(-2.0 * lumaLeft + lumaLeftCorners) +\n		abs(-2.0 * lumaCenter + lumaDownUp ) * 2.0 +\n		abs(-2.0 * lumaRight + lumaRightCorners)\n	);\n\n	float edgeVertical = (\n		abs(-2.0 * lumaUp + lumaUpCorners) +\n		abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 +\n		abs(-2.0 * lumaDown + lumaDownCorners)\n	);\n\n	// Check if the local edge is horizontal or vertical.\n	bool isHorizontal = (edgeHorizontal >= edgeVertical);\n\n	// Choose the step size (one pixel) accordingly.\n	float stepLength = isHorizontal ? texelSize.y : texelSize.x;\n\n	// Select the two neighboring texels' lumas in the opposite direction to the local edge.\n	float luma1 = isHorizontal ? lumaDown : lumaLeft;\n	float luma2 = isHorizontal ? lumaUp : lumaRight;\n\n	// Compute gradients in this direction.\n	float gradient1 = abs(luma1 - lumaCenter);\n	float gradient2 = abs(luma2 - lumaCenter);\n\n	// Check which direction is the steepest.\n	bool is1Steepest = gradient1 >= gradient2;\n\n	// Gradient in the corresponding direction, normalized.\n	float gradientScaled = 0.25 * max(gradient1, gradient2);\n\n	// Average luma in the correct direction.\n	float lumaLocalAverage = 0.0;\n\n	if(is1Steepest) {\n\n		// Switch the direction.\n		stepLength = -stepLength;\n		lumaLocalAverage = 0.5 * (luma1 + lumaCenter);\n\n	} else {\n\n		lumaLocalAverage = 0.5 * (luma2 + lumaCenter);\n\n	}\n\n	// Shift UV in the correct direction by half a pixel.\n	vec2 currentUv = uv;\n\n	if(isHorizontal) {\n\n		currentUv.y += stepLength * 0.5;\n\n	} else {\n\n		currentUv.x += stepLength * 0.5;\n\n	}\n\n	// Compute offset (for each iteration step) in the right direction.\n	vec2 offset = isHorizontal ? vec2(texelSize.x, 0.0) : vec2(0.0, texelSize.y);\n\n	// Compute UVs to explore on each side of the edge, orthogonally. The QUALITY allows us to step faster.\n	vec2 uv1 = currentUv - offset * QUALITY(0);\n	vec2 uv2 = currentUv + offset * QUALITY(0);\n\n	// Read lumas at both extremities of the exploration segment, and compute the delta w.r.t. the local average luma.\n	float lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\n	float lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\n	lumaEnd1 -= lumaLocalAverage;\n	lumaEnd2 -= lumaLocalAverage;\n\n	// If the deltas at the current extremities are larger than the local gradient, the side of the edge has been reached.\n	bool reached1 = abs(lumaEnd1) >= gradientScaled;\n	bool reached2 = abs(lumaEnd2) >= gradientScaled;\n	bool reachedBoth = reached1 && reached2;\n\n	// If the side has not been reached, continue to explore in this direction.\n	if(!reached1) {\n\n		uv1 -= offset * QUALITY(1);\n\n	}\n\n	if(!reached2) {\n\n		uv2 += offset * QUALITY(1);\n\n	}\n\n	// If both sides have not been reached, continue to explore.\n	if(!reachedBoth) {\n\n		for(int i = 2; i < uSamples; ++i) {\n\n			// If needed, read luma in 1st direction, compute delta.\n			if(!reached1) {\n\n				lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\n				lumaEnd1 = lumaEnd1 - lumaLocalAverage;\n\n			}\n\n			// If needed, read luma in opposite direction, compute delta.\n			if(!reached2) {\n\n				lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\n				lumaEnd2 = lumaEnd2 - lumaLocalAverage;\n\n			}\n\n			// If the deltas are larger than the local gradient, the side of the edge has been reached.\n			reached1 = abs(lumaEnd1) >= gradientScaled;\n			reached2 = abs(lumaEnd2) >= gradientScaled;\n			reachedBoth = reached1 && reached2;\n			\n			// If the side has not been reached, continue to explore in this direction, with dynamic quality.\n			if(!reached1) {\n\n				uv1 -= offset * QUALITY(i);\n\n			}\n\n			if(!reached2) {\n\n				uv2 += offset * QUALITY(i);\n\n			}\n\n			// If both sides have been reached, stop the exploration.\n			if(reachedBoth) {\n\n				break;\n\n			}\n\n		}\n\n	}\n\n	// Compute the distances to each side edge of the edge (!).\n	float distance1 = isHorizontal ? (uv.x - uv1.x) : (uv.y - uv1.y);\n	float distance2 = isHorizontal ? (uv2.x - uv.x) : (uv2.y - uv.y);\n\n	// Check in which direction the side of the edge is closer.\n	bool isDirection1 = distance1 < distance2;\n	float distanceFinal = min(distance1, distance2);\n\n	// Thickness of the edge.\n	float edgeThickness = (distance1 + distance2);\n\n	// Check if the luma at the center is smaller than the local average.\n	bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;\n\n	// If the luma is smaller than at its neighbour, the delta luma at each end should be positive (same variation).\n	bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;\n	bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;\n\n	// Only keep the result in the direction of the closer side of the edge.\n	bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;\n\n	// UV offset: read in the direction of the closest side of the edge.\n	float pixelOffset = -distanceFinal / edgeThickness + 0.5;\n\n	// If the luma variation is incorrect, do not offset.\n	float finalOffset = correctVariation ? pixelOffset : 0.0;\n\n	// Sub-Pixel Shifting\n	// Full weighted average of the luma over the 3x3 neighborhood.\n	float lumaAverage = ONE_OVER_TWELVE * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);\n	// Ratio of the delta between the global average and the center luma, over the luma range in the 3x3 neighborhood.\n	float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);\n	float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;\n	// Compute a sub-pixel offset based on this delta.\n	float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * SUBPIXEL_QUALITY;\n\n	// Pick the biggest of the two offsets.\n	finalOffset = max(finalOffset, subPixelOffsetFinal);\n\n	// Compute the final UV coordinates.\n	vec2 finalUv = uv;\n\n	if(isHorizontal) {\n\n		finalUv.y += finalOffset * stepLength;\n\n	} else {\n\n		finalUv.x += finalOffset * stepLength;\n\n	}\n\n	return texture2D(inputBuffer, finalUv);\n\n}\n\nvoid main() {\n\n    vec3 inputColor = texture2D(tDiffuse, vUv).rgb;\n\n    // Luma at the current fragment.\n	float lumaCenter = luminance(inputColor.rgb);\n\n    const float edgeDetectionQuality = .2;\n    const float invEdgeDetectionQuality = 1. / edgeDetectionQuality;\n\n    gl_FragColor = fxaa(\n        tDiffuse,\n        vUv\n    );\n\n    // gl_FragColor.rgb = vec3(lumaCenter);\n\n}",uniforms:{tDiffuse:{value:new b.gPd},uSamples:{value:8,gui:{min:0,step:1}}},defines:{EDGE_THRESHOLD_MIN:.009,EDGE_THRESHOLD_MAX:.125,SUBPIXEL_QUALITY:.85},name:"FXAAMaterial"})),this.compositePass=new j.p(new W({vertexShader:"varying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#include <default_pars>\n#include <default_frag_pars>\n\nvarying vec2 vUv;\n\nuniform bool uEnabled;\nuniform bool uChromaticAberration;\nuniform bool uVignette;\nuniform bool uNoise;\n\nuniform vec2 uResolution;\n\nuniform sampler2D tDiffuse;\nuniform float uNoiseStrength;\n\n// vignette\nuniform float uVignetteStrength;\nuniform float uVignetteInnerStrength;\nuniform float uVignetteOuterStrength;\nuniform vec3 uVignetteColor;\n\n// chromatic aberration\nuniform float uMaxDistort;\nuniform float uBendAmount;\nconst int iterations = 5;\n\nvec2 barrelDistortion(vec2 coord, float amt) {\n	vec2 cc = coord - 0.5;\n	float dist = dot(cc, cc);\n	return coord + cc * dist * amt;\n}\n\nfloat sat(float t) {\n	return clamp(t, 0.0, 1.0);\n}\n\nfloat linterp(float t) {\n	return sat(1.0 - abs(2.0 * t - 1.0));\n}\n\nfloat remap(float t, float a, float b) {\n	return sat((t - a) / (b - a));\n}\n\nvec4 spectrum_offset(float t) {\n	vec4 ret;\n	float lo = step(t, 0.5);\n	float hi = 1.0 - lo;\n	float w = linterp(remap(t, 1.0 / 6.0, 5.0 / 6.0));\n	ret = vec4(lo, 1.0, hi, 1.) * vec4(1.0 - w, w, 1.0 - w, 1.);\n\n	return pow(ret, vec4(1.0 / 2.2));\n}\n\nfloat random(vec2 p) {\n	vec3 p3 = fract(vec3(p.xyx) * 443.8975);\n	p3 += dot(p3, p3.yzx + 19.19);\n	return fract((p3.x + p3.y) * p3.z);\n}\n\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\n//float luminance(vec3 color) {\n//    return dot(color, W);\n//}\n\nvoid main() {\n	if (uEnabled) {\n\n		if (uChromaticAberration) {\n			vec4 sumcol = vec4(0.0);\n			vec4 sumw = vec4(0.0);\n			float reci_num_iter_f = 1.0 / float(iterations);\n			for (int i = 0; i < iterations; i++) {\n				float t = float(i) * reci_num_iter_f;\n				vec4 w = spectrum_offset(t);\n				sumw += w;\n				sumcol += w * texture2D(tDiffuse, barrelDistortion(vUv, uBendAmount * uMaxDistort * t));\n			}\n\n			gl_FragColor = vec4(sumcol / sumw);\n		} else {\n			gl_FragColor = texture2D(tDiffuse, vUv);\n		}\n\n		if (uVignette) {\n			vec2 coord = (vUv - 0.5) * (uResolution.x / uResolution.y) * 2.0;\n			float rf = 1.0 + dot(coord, coord) * uVignetteInnerStrength * uVignetteInnerStrength;\n			float vignette = 1.0 / (rf * rf);\n			// vignette = pow(vignette, uVignetteStrength);\n\n			vec2 uv2 = vUv;\n			uv2 *= 1.0 - vUv.yx;\n			float vig = uv2.x * uv2.y * 20.0;\n			vignette *= pow(vig, uVignetteOuterStrength);\n			vignette = clamp(vignette, 0.0, 1.0);\n\n			gl_FragColor.rgb = mix(uVignetteColor, gl_FragColor.rgb, saturate(vignette + (1. - uVignetteStrength)));\n		}\n\n		if (uNoise) {\n			// gl_FragColor.rgb += (random(vUv) - 0.5) * uNoiseStrength;\n			float noise = random(vUv) - 0.5;\n			gl_FragColor.rgb = blendSoftLight(gl_FragColor.rgb, vec3(noise), uNoiseStrength);\n			gl_FragColor.a += noise * uNoiseStrength;\n		}\n	} else {\n		gl_FragColor = texture2D(tDiffuse, vUv);\n	}\n\n	#include <colorspace_fragment>\n}\n",uniforms:{tDiffuse:{value:new b.gPd},uEnabled:{value:!0},uChromaticAberration:{value:!0},uVignette:{value:!1},uNoise:{value:!0},uMaxDistort:{value:.08,gui:{step:.01}},uBendAmount:{value:-.16,gui:{step:.01}},uVignetteStrength:{value:.9,gui:{min:0,max:1,step:.01}},uVignetteInnerStrength:{value:.45,gui:{min:0,max:1,step:.01}},uVignetteOuterStrength:{value:1,gui:{min:0,max:1,step:.01}},uVignetteColor:{value:new b.Q1f(0)},uNoiseStrength:{value:.035,gui:{min:0,max:1,step:.001}}},name:"FinalComposite"})),this.composerPasses.add(this.fxaaPass,102),this.composerPasses.add(this.bloomPass,103),this.composerPasses.add(this.compositePass,104),this.Gui){let e=this.Gui.addFolder({title:"Post Processing",expanded:!1}),n=e.addFolder({title:"Tone Mapping",expanded:!0});n.addBinding(this.globalUniforms.uToneMapping,"value",{label:"Tone Mapping",options:{LinearToneMapping:0,ReinhardToneMapping:1,OptimizedCineonToneMapping:2,ACESFilmicToneMapping:3,NeutralToneMapping:4}}),n.addBinding(this.globalUniforms.toneMappingExposure,"value",{label:"Exposure",min:0,max:5,step:.01});let t=e.addFolder({title:"Bloom Pass",expanded:!0});t.addBinding(this.bloomPass,"enabled",{label:"enabled"}),t.addBinding(this.bloomPass,"strength",{label:"strength",min:0,max:1,step:.001}),t.addBinding(this.bloomPass,"radius",{label:"radius",min:0,max:1,step:.001}),t.addBinding(this.bloomPass,"threshold",{label:"threshold",min:0,max:1,step:.001});let i=e.addFolder({title:"FXAA",expanded:!0});i.addBinding(this.fxaaPass,"enabled"),this.Gui.autoAddMaterial({folder:i,material:this.fxaaPass.material});let a=e.addFolder({title:"Composite Pass",expanded:!0});this.Gui.autoAddUniforms(a,this.compositePass.material.uniforms,["uDevCameraActive"])}}build(){if(!this.ready){for(let n in this.sceneName||(this.sceneName=Object.keys(this.scenes)[0]),this.scenes){var e;null==(e=this.scenes[n])||e.build()}this.buildPasses(),this.ready=!0}}start(){var e;this.enabled||(this.enabled=!0,null==(e=this.scenes[this.sceneName])||e.start())}stop(){var e;this.enabled&&(this.enabled=!1,null==(e=this.scenes[this.sceneName])||e.stop())}preRender(){for(let e in this.scenes)this.scenes[e]&&(this.renderer.compile(this.scenes[e],this.scenes[e].activeCamera),this.scenes[e].renderPass.enabled=!0);for(let e in this.composer.render(),this.scenes)this.scenes[e]&&(this.scenes[e].renderPass.enabled=!1)}setViewport(){let e=window.innerHeight,n=screen.availHeight,t=window.visualViewport?window.visualViewport.height:e,i=eP()?Math.max(e,n,t):document.documentElement.clientHeight;eA.Viewport={w:document.documentElement.clientWidth,lvh:e,svh:n,dvh:t,h:i,ratio:document.documentElement.clientWidth/i,dpr:ez(),isTouch:eN(),isMobile:e_(),isTablet:!e_()&&eP(),isDesktop:!e_()&&!eP()}}destroy(){for(let n in this.stop(),this.scenes){var e;null==(e=this.scenes[n])||e.stop()}this.composer.dispose(),this.renderer.dispose(),this.ready=!1}generateTexture(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof HTMLImageElement&&(e=new b.gPd(e)),e.minFilter=n.minFilter||b.$_I,e.magFilter=n.magFilter||b.k6q,e.wrapS=e.wrapT=n.wrapping||b.ghU,e.flipY=void 0===n.flipY||n.flipY,e.colorSpace=n.colorSpace||b.Zr2,e.mapping=n.mapping||b.UTZ,e.generateMipmaps=void 0===n.generateMipmaps||n.generateMipmaps,e.anisotropy=n.anisotropy||1,this.renderer.initTexture(e),e}constructor(e,n){this.scenes={},this.pointer={x:0,y:0,gl:new b.I9Y,glNormalized:new b.I9Y,glScreenSpace:new b.I9Y},this.enabled=!1,this.ready=!1,this.beforeRender=e=>{let n=this.clock.getDelta();this.globalUniforms.uDelta.value=n>.016?.016:n,this.globalUniforms.uTime.value=e.timestamp,n=Math.round(1e3*n)/1e3;let t=(n=b.cj9.clamp(n,0,.016))/.016;this.globalUniforms.uNormalizedDelta.value=t,this.renderer.info.reset()},this.render=()=>{this.composer.render()},this.resize=()=>{this.setViewport(),this.renderer.setSize(eA.Viewport.w,eA.Viewport.h),this.composer.setSize(eA.Viewport.w,eA.Viewport.h),this.globalUniforms.uResolution.value.set(eA.Viewport.w*this.renderer.getPixelRatio(),eA.Viewport.h*this.renderer.getPixelRatio())},this.pointerMove=e=>{this.pointer.x="changedTouches"in e?e.changedTouches[0].clientX:e.clientX,this.pointer.y="changedTouches"in e?e.changedTouches[0].clientY:e.clientY,this.pointer.gl.set(this.pointer.x-eA.Viewport.w/2,-this.pointer.y+eA.Viewport.h/2),this.pointer.glNormalized.set(this.pointer.x/eA.Viewport.w*2-1,-(2*(this.pointer.y/eA.Viewport.h))+1),this.pointer.glScreenSpace.set(this.pointer.x/eA.Viewport.w,1-this.pointer.y/eA.Viewport.h),this.activeScene&&"handlePointerMove"in this.activeScene&&"function"==typeof this.activeScene.handlePointerMove&&this.activeScene.handlePointerMove()},eA.instance=this,this.el=e,this.renderer=new k.JeP({canvas:this.el,alpha:!1,antialias:!1,powerPreference:"high-performance",stencil:!1}),this.options=n,this.context=this.options.context,this.setViewport(),this.renderer.setPixelRatio(eA.Viewport.dpr>=2?2:eA.Viewport.dpr),this.renderer.setSize(eA.Viewport.w,eA.Viewport.h),this.renderer.info.autoReset=!1,this.composer=new B.s(this.renderer),this.composerPasses=new eR(this.composer.passes),this.clock=new b.zD7,this.globalUniforms={uDelta:{value:0},uNormalizedDelta:{value:0},uTime:{value:0},uResolution:{value:new b.I9Y(eA.Viewport.w*this.renderer.getPixelRatio(),eA.Viewport.h*this.renderer.getPixelRatio())},uDevCameraActive:{value:!1},uToneMapping:{value:3},toneMappingExposure:{value:1}},this.factory={BaseScene:eb,GlobeScene:eM},this.sceneName=n.sceneName,k.vxI.blending_overlay_pars=H("float blendAdd(float base, float blend) {\n	return min(base+blend,1.0);\n}\n\nvec3 blendAdd(vec3 base, vec3 blend) {\n	return min(base+blend,vec3(1.0));\n}\n\nvec3 blendAdd(vec3 base, vec3 blend, float opacity) {\n	return (blendAdd(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_linearLight_pars=H("float blendColorDodge(float base, float blend) {\n	return (blend==1.0)?blend:min(base/(1.0-blend),1.0);\n}\n\nvec3 blendColorDodge(vec3 base, vec3 blend) {\n	return vec3(blendColorDodge(base.r,blend.r),blendColorDodge(base.g,blend.g),blendColorDodge(base.b,blend.b));\n}\n\nvec3 blendColorDodge(vec3 base, vec3 blend, float opacity) {\n	return (blendColorDodge(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_colorDodge_pars=H("float blendLighten(float base, float blend) {\n	return max(blend,base);\n}\n\nvec3 blendLighten(vec3 base, vec3 blend) {\n	return vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));\n}\n\nvec3 blendLighten(vec3 base, vec3 blend, float opacity) {\n	return (blendLighten(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_softLight_pars=H("float blendLinearBurn(float base, float blend) {\n	// Note : Same implementation as BlendSubtractf\n	return max(base+blend-1.0,0.0);\n}\n\nvec3 blendLinearBurn(vec3 base, vec3 blend) {\n	// Note : Same implementation as BlendSubtract\n	return max(base+blend-vec3(1.0),vec3(0.0));\n}\n\nvec3 blendLinearBurn(vec3 base, vec3 blend, float opacity) {\n	return (blendLinearBurn(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_screen_pars=H("float blendLinearDodge(float base, float blend) {\n	// Note : Same implementation as BlendAddf\n	return min(base+blend,1.0);\n}\n\nvec3 blendLinearDodge(vec3 base, vec3 blend) {\n	// Note : Same implementation as BlendAdd\n	return min(base+blend,vec3(1.0));\n}\n\nvec3 blendLinearDodge(vec3 base, vec3 blend, float opacity) {\n	return (blendLinearDodge(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_linearDodge_pars=H("float blendLinearLight(float base, float blend) {\n	return blend<0.5?blendLinearBurn(base,(2.0*blend)):blendLinearDodge(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendLinearLight(vec3 base, vec3 blend) {\n	return vec3(blendLinearLight(base.r,blend.r),blendLinearLight(base.g,blend.g),blendLinearLight(base.b,blend.b));\n}\n\nvec3 blendLinearLight(vec3 base, vec3 blend, float opacity) {\n	return (blendLinearLight(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_lighten_pars=H("vec3 blendMultiply(vec3 base, vec3 blend) {\n	return base*blend;\n}\n\nvec3 blendMultiply(vec3 base, vec3 blend, float opacity) {\n	return (blendMultiply(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_linearBurn_pars=H("float blendOverlay(float base, float blend) {\n	return base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend) {\n	return vec3(blendOverlay(base.r,blend.r),blendOverlay(base.g,blend.g),blendOverlay(base.b,blend.b));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend, float opacity) {\n	return (blendOverlay(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.blending_multiply_pars=H("float blendScreen(float base, float blend) {\n	return 1.0-((1.0-base)*(1.0-blend));\n}\n\nvec3 blendScreen(vec3 base, vec3 blend) {\n	return vec3(blendScreen(base.r,blend.r),blendScreen(base.g,blend.g),blendScreen(base.b,blend.b));\n}\n\nvec3 blendScreen(vec3 base, vec3 blend, float opacity) {\n	return (blendScreen(base, blend) * opacity + base * (1.0 - opacity));\n}\n"),k.vxI.blending_add_pars=H("float blendSoftLight(float base, float blend) {\n	return (blend<0.5)?(2.0*base*blend+base*base*(1.0-2.0*blend)):(sqrt(base)*(2.0*blend-1.0)+2.0*base*(1.0-blend));\n}\n\nvec3 blendSoftLight(vec3 base, vec3 blend) {\n	return vec3(blendSoftLight(base.r,blend.r),blendSoftLight(base.g,blend.g),blendSoftLight(base.b,blend.b));\n}\n\nvec3 blendSoftLight(vec3 base, vec3 blend, float opacity) {\n	return (blendSoftLight(base, blend) * opacity + base * (1.0 - opacity));\n}"),k.vxI.default_pars=H("#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\n#if defined(USE_ENV) || defined(USE_FOG)\n  // Shader chunk that handles sampling the mipmapped image\n  #include <cubeUVreflectionFrag>\n#endif\n\nvec3 transformDirection(in vec3 dir, in mat4 matrix) {\n  return normalize((matrix * vec4(dir, 0.0)).xyz);\n}\nvec3 inverseTransformDirection(in vec3 dir, in mat4 matrix) {\n		// dir can be either a direction vector or a normal vector\n		// upper-left 3x3 of matrix is assumed to be orthogonal\n  return normalize((vec4(dir, 0.0) * matrix).xyz);\n}"),k.vxI.default_frag_pars=H("#include <blending_overlay_pars>\n#include <blending_linearLight_pars>\n#include <blending_colorDodge_pars>\n#include <blending_softLight_pars>\n#include <blending_screen_pars>\n#include <blending_linearDodge_pars>\n#include <blending_lighten_pars>\n#include <blending_linearBurn_pars>\n#include <blending_multiply_pars>\n#include <blending_add_pars>\n\n#ifndef saturate\n  // <tonemapping_pars_fragment> may have defined saturate() already\n  #define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\n\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\n\nvec3 sRGBToLinear( in vec3 value ) {\n  return vec3( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ) );\n}\n"),k.vxI.normalsVert=H("vec3 objectNormal = vec3( normal );\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n    mat3 m = mat3( instanceMatrix );\n    transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n    transformedNormal = m * transformedNormal;\n#endif\n\ntransformedNormal = normalMatrix * transformedNormal;\n\nvNormal = normalize( transformedNormal );"),k.vxI.tonemapping_frag=H("#ifdef USE_TONEMAPPING\n        \n    if(uToneMapping == 0) {\n        gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n    } else if (uToneMapping == 1) {\n        gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n    } else if (uToneMapping == 2) {\n        gl_FragColor.rgb = OptimizedCineonToneMapping( gl_FragColor.rgb );\n    } else {\n        gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n    }\n\n#endif"),k.vxI.cubeUVreflectionFrag=H("#define cubeUV_minMipLevel 4.0\n#define cubeUV_minTileSize 16.0\n\n// These shader functions convert between the UV coordinates of a single face of\n// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n// sampling a textureCube (not generally normalized ).\n\nfloat getFace( vec3 direction ) {\n\n	vec3 absDirection = abs( direction );\n\n	float face = - 1.0;\n\n	if ( absDirection.x > absDirection.z ) {\n\n		if ( absDirection.x > absDirection.y )\n\n			face = direction.x > 0.0 ? 0.0 : 3.0;\n\n		else\n\n			face = direction.y > 0.0 ? 1.0 : 4.0;\n\n	} else {\n\n		if ( absDirection.z > absDirection.y )\n\n			face = direction.z > 0.0 ? 2.0 : 5.0;\n\n		else\n\n			face = direction.y > 0.0 ? 1.0 : 4.0;\n\n	}\n\n	return face;\n\n}\n\n// RH coordinate system; PMREM face-indexing convention\nvec2 getUV( vec3 direction, float face ) {\n\n	vec2 uv;\n\n	if ( face == 0.0 ) {\n\n		uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x\n\n	} else if ( face == 1.0 ) {\n\n		uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y\n\n	} else if ( face == 2.0 ) {\n\n		uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z\n\n	} else if ( face == 3.0 ) {\n\n		uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x\n\n	} else if ( face == 4.0 ) {\n\n		uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y\n\n	} else {\n\n		uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z\n\n	}\n\n	return 0.5 * ( uv + 1.0 );\n\n}\n\nvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\n	float face = getFace( direction );\n\n	float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\n	mipInt = max( mipInt, cubeUV_minMipLevel );\n\n	float faceSize = exp2( mipInt );\n\n	highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0; // #25071\n\n	if ( face > 2.0 ) {\n\n		uv.y += faceSize;\n\n		face -= 3.0;\n\n	}\n\n	uv.x += face * faceSize;\n\n	uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\n	uv.y += 4.0 * ( exp2( float(CUBEUV_MAX_MIP) ) - faceSize );\n\n	uv.x *= CUBEUV_TEXEL_WIDTH;\n	uv.y *= CUBEUV_TEXEL_HEIGHT;\n\n	#ifdef texture2DGradEXT\n\n		return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb; // disable anisotropic filtering\n\n	#else\n\n		return texture2D( envMap, uv ).rgb;\n\n	#endif\n\n}\n\n// These defines must match with PMREMGenerator\n#define cubeUV_r0 1.0\n#define cubeUV_v0 0.339\n#define cubeUV_m0 - 2.0\n#define cubeUV_r1 0.8\n#define cubeUV_v1 0.276\n#define cubeUV_m1 - 1.0\n#define cubeUV_r4 0.4\n#define cubeUV_v4 0.046\n#define cubeUV_m4 2.0\n#define cubeUV_r5 0.305\n#define cubeUV_v5 0.016\n#define cubeUV_m5 3.0\n#define cubeUV_r6 0.21\n#define cubeUV_v6 0.0038\n#define cubeUV_m6 4.0\n\nfloat roughnessToMip( float roughness ) {\n\n	float mip = 0.0;\n\n	if ( roughness >= cubeUV_r1 ) {\n\n		mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\n	} else if ( roughness >= cubeUV_r4 ) {\n\n		mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\n	} else if ( roughness >= cubeUV_r5 ) {\n\n		mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\n	} else if ( roughness >= cubeUV_r6 ) {\n\n		mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\n	} else {\n\n		mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25\n	}\n\n	return mip;\n\n}\n\nvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\n	float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, float(CUBEUV_MAX_MIP) );\n\n	float mipF = fract( mip );\n\n	float mipInt = floor( mip );\n\n	vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\n	if ( mipF == 0.0 ) {\n\n		return vec4( color0, 1.0 );\n\n	} else {\n\n		vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\n		return vec4( mix( color0, color1, mipF ), 1.0 );\n\n	}\n\n}\n"),k.vxI.circle_pars=H("float circle(in vec2 _st, in float _scale, in float _radius, in float _fade) {\n	vec2 dist = _st / _scale;\n	return 1.-smoothstep(_radius-(_radius*_fade), _radius+(_radius*_fade), dot(dist, dist)*4.0);\n}\n"),k.vxI.cnoise_pars=H("//	Classic Perlin 2D Noise\n//	by Stefan Gustavson\n//\n\n\nvec3 mod289(vec3 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n	return mod289(((x*34.0)+10.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n	return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}\n\nfloat cnoise(vec3 P){\n	vec3 Pi0 = floor(P); // Integer part for indexing\n	vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n	Pi0 = mod(Pi0, 289.0);\n	Pi1 = mod(Pi1, 289.0);\n	vec3 Pf0 = fract(P); // Fractional part for interpolation\n	vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n	vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n	vec4 iy = vec4(Pi0.yy, Pi1.yy);\n	vec4 iz0 = Pi0.zzzz;\n	vec4 iz1 = Pi1.zzzz;\n\n	vec4 ixy = permute(permute(ix) + iy);\n	vec4 ixy0 = permute(ixy + iz0);\n	vec4 ixy1 = permute(ixy + iz1);\n\n	vec4 gx0 = ixy0 / 7.0;\n	vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n	gx0 = fract(gx0);\n	vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n	vec4 sz0 = step(gz0, vec4(0.0));\n	gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n	gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n	vec4 gx1 = ixy1 / 7.0;\n	vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n	gx1 = fract(gx1);\n	vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n	vec4 sz1 = step(gz1, vec4(0.0));\n	gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n	gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n	vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n	vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n	vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n	vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n	vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n	vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n	vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n	vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n	vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n	g000 *= norm0.x;\n	g010 *= norm0.y;\n	g100 *= norm0.z;\n	g110 *= norm0.w;\n	vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n	g001 *= norm1.x;\n	g011 *= norm1.y;\n	g101 *= norm1.z;\n	g111 *= norm1.w;\n\n	float n000 = dot(g000, Pf0);\n	float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n	float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n	float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n	float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n	float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n	float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n	float n111 = dot(g111, Pf1);\n\n	vec3 fade_xyz = fade(Pf0);\n	vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n	vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n	float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n	return 2.2 * n_xyz;\n}\n"),k.vxI.ambient_light_pars=H("vec3 ambientLight(\n    vec3 color,\n    float intensity\n) {\n    return color * intensity;\n}\n"),k.vxI.directional_light_pars=H("vec3 directionalLight(\n    vec3 color,\n    float intensity,\n    vec2 specularPower,\n    vec3 origin,\n    vec3 normal,\n    vec3 viewDirection\n) {\n    vec3 direction = normalize(origin);\n    vec3 reflection = reflect(-direction, normal);\n\n    float shading = dot(normal, direction);\n    shading = max(0., shading);\n\n    float specular = -dot(reflection, viewDirection);\n    specular = max(0., specular);\n    specular = pow(specular, specularPower.x);\n    specular = max(0., specular * specularPower.y);\n\n    return color * intensity * (shading + specular);\n}\n"),k.vxI.point_light_pars=H("vec3 pointLight(\n    vec3 color,\n    float intensity,\n    vec2 specularPower,\n    vec3 origin,\n    vec3 normal,\n    vec3 viewDirection,\n    vec3 position,\n    float decay\n) {\n    vec3 delta = origin - position;\n    float dist = length(delta);\n    vec3 direction = normalize(delta);\n    vec3 reflection = reflect(-direction, normal);\n\n    float shading = dot(normal, direction);\n    shading = max(0., shading);\n\n    float specular = -dot(reflection, viewDirection);\n    specular = max(0., specular);\n    specular = pow(specular, specularPower.x);\n    specular = max(0., specular * specularPower.y);\n\n    float d = 1.0 - dist * decay;\n    d = max(0., d);\n\n    return color * intensity * decay * (shading + specular);\n}\n"),k.vxI.spot_light_pars=H("vec3 spotLight(\n    vec3 color,\n    float intensity,\n    vec2 specularPower,\n    vec3 origin,\n    vec3 normal,\n    vec3 viewDirection,\n    vec3 position,\n    float decay,\n    vec3 direction,\n    float innerCutoff,\n    float outerCutoff\n) {\n    vec3 delta = origin - position;\n    float dist = length(delta);\n    vec3 lightDir = normalize(delta);\n    vec3 reflection = reflect(-lightDir, normal);\n\n    float shading = dot(normal, lightDir);\n    shading = max(0., shading);\n\n    float specular = -dot(reflection, viewDirection);\n    specular = max(0., specular);\n    specular = pow(specular, specularPower.x);\n    specular = max(0., specular * specularPower.y);\n\n    float d = 1.0 - dist * decay;\n    d = max(0., d);\n\n    float theta = dot(lightDir, normalize(-direction));\n    float epsilon = innerCutoff - outerCutoff;\n    float spotEffect = smoothstep(outerCutoff, innerCutoff, theta);\n\n    return color * intensity * d * spotEffect * (shading + specular);\n}\n"),k.vxI.msdf_vert_pars=H("attribute vec2 aPosition;\nattribute vec2 aOffset;\nattribute vec2 aSize;\nattribute float aIndex;\nattribute float aWord;\nattribute float aLine;\nattribute float aLength;\nattribute float aPage;\n\nuniform float uFontBase;\nuniform float uFontLineHeight;\nuniform float uFontSize;\nuniform float uLayoutDescender;\n\nvarying vec2 vUv;\nvarying vec2 vPosition;\nvarying vec2 vOffset;\nvarying vec2 vSize;\nvarying float vIndex;\nvarying float vWord;\nvarying float vLine;\nvarying float vLength;\nvarying float vPage;\n"),k.vxI.msdf_vert=H("vUv = uv;\nvPosition = aPosition;\nvOffset = aOffset;\nvSize = aSize;\nvIndex = aIndex;\nvWord = aWord;\nvLine = aLine;\nvLength = aLength;\nvPage = aPage;\n\nvec3 transformedPos = position;\n"),k.vxI.msdf_frag_pars=H("precision highp float;\n\nuniform float uOpacity;\nuniform vec3 uColor;\n\nuniform float uFontBase;\nuniform float uFontLineHeight;\nuniform float uFontSize;\nuniform float uLayoutDescender;\n\nvarying vec2 vUv;\nvarying vec2 vPosition;\nvarying vec2 vOffset;\nvarying vec2 vSize;\nvarying float vIndex;\nvarying float vWord;\nvarying float vLine;\nvarying float vLength;\nvarying float vPage;\n\nfloat median(float r, float g, float b) {\n	return max(min(r, g), min(max(r, g), b));\n}\n\nfloat spxRange(sampler2D tex, vec2 uv) {\n	vec2 unit = vec2(6.0) / vec2(textureSize(tex, 0));\n	vec2 screen = vec2(1.0) / fwidth(uv);\n\n	return max(0.5*dot(unit, screen), 1.0);\n}\n"),k.vxI.msdf_frag=H("// MSDF MAP\nvec3 bitmap = msdf();\nfloat range = pxRange();\n\n// FILL\nfloat sigDist = median(bitmap.r, bitmap.g, bitmap.b);\nfloat pxDist = range * (sigDist - 0.5);\nfloat alpha = clamp(pxDist + 0.5, 0.0, 1.0);\n\n// MASK\nfloat mask = clamp(alpha * uOpacity, 0., 1.);\n\n// TEXTURE RENDER\ngl_FragColor = vec4(uColor.xyz, alpha);\n"),k.vxI.msdf_base_anim_vert_pars=H("uniform float uProgress;\nuniform float uStagger;\n\nvarying float vDiff;\n\nfloat textAnimation (float bound, float index, float stagger) {\n	return (bound * stagger) * (index) + bound;\n}\n"),k.vxI.msdf_base_anim_vert=H("float progress = (1. - uProgress);\n\n#ifdef ANIM_CHAR_X\ntransformedPos.x -= textAnimation(aSize.x, aIndex, uStagger) * progress;\n\nvDiff = transformedPos.x;\n#endif\n\n#ifdef ANIM_CHAR_Y\ntransformedPos.y += textAnimation(uFontLineHeight, aIndex, uStagger) * progress;\n\nvDiff = transformedPos.y;\n#endif\n\n#ifdef ANIM_WORD_X\ntransformedPos.x -= textAnimation(aSize.x, aWord, uStagger) * progress;\n\nvDiff = transformedPos.x;\n#endif\n\n#ifdef ANIM_WORD_Y\ntransformedPos.y += textAnimation(uFontLineHeight, aWord, uStagger) * progress;\n\nvDiff = transformedPos.y;\n#endif\n\n#ifdef ANIM_LINE_X\ntransformedPos.x -= textAnimation(aSize.x, aLine, uStagger) * progress;\n\nvDiff = transformedPos.x;\n#endif\n\n#ifdef ANIM_LINE_Y\ntransformedPos.y += textAnimation(uFontLineHeight, aLine, uStagger) * progress;\n\nvDiff = transformedPos.y;\n#endif\n"),k.vxI.msdf_base_anim_frag_pars=H("varying float vDiff;\n"),k.vxI.msdf_base_anim_frag=H("#ifdef ANIM_CHAR_X\nif(vDiff < (vPosition.x + vOffset.x)) discard;\n#endif\n\n#ifdef ANIM_CHAR_Y\nif(vDiff > (vPosition.y + uFontLineHeight)) discard;\n#endif\n\n#ifdef ANIM_WORD_X\nif(vDiff < (vPosition.x + vOffset.x)) discard;\n#endif\n\n#ifdef ANIM_WORD_Y\nif(vDiff > (vPosition.y + uFontLineHeight)) discard;\n#endif\n\n#ifdef ANIM_LINE_X\nif(vDiff < (vPosition.x + vOffset.x)) discard;\n#endif\n\n#ifdef ANIM_LINE_Y\nif(vDiff > (vPosition.y + uFontLineHeight)) discard;\n#endif\n"),k.vxI.normals_tangents_vert_pars=H("attribute vec4 tangent;\n\nvarying vec3 vNormal;\nvarying vec3 vTangent;\nvarying vec3 vBitangent;"),k.vxI.normals_tangents_vert=H("vec3 objectNormal = vec3( normal );\nvec3 objectTangent = vec3( tangent.xyz );\n\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n	mat3 m = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n	transformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\nvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\nvNormal = normalize( transformedNormal );\nvTangent = normalize( transformedTangent );\nvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );"),k.vxI.world_position_transform_vert_pars=H("varying vec3 vViewPosition;\nvarying vec4 vWorldPosition;"),k.vxI.world_position_transform_vert=H("vec4 worldPosition = modelMatrix * transformedPosition;"),k.vxI.instance_offset_vert=H("#ifdef USE_INSTANCING\n    transformedPosition = instanceMatrix * transformedPosition;\n#endif"),k.vxI.mv_position_transform_vert=H("vec4 mvPosition = viewMatrix * worldPosition;"),k.vxI.varyings_vert=H("vViewPosition = - mvPosition.xyz;\nvWorldPosition = worldPosition;"),k.vxI.dynamic_frag_pars=H("struct DynamicMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n    float ior;\n};\n\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\n\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n};\n\n#include <lights_pars_begin>\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;\nvarying vec3 vTangent;\nvarying vec3 vBitangent;\n\nuniform float uOpacity;\nuniform float uMetalness;\nuniform float uSpecularIntensity;\nuniform vec3 uEmissiveColor;\nuniform vec3 uSpecularColor;\n\nuniform float uDiffuseMatcapBlend;\n\nuniform vec3 uColor;\nuniform int uMatcapBlendMode;\n\n#ifdef USE_MATCAP\n    uniform sampler2D tMatcap;\n#endif\n\n#ifdef USE_UDIMS\n	#define MAX_UDIMS 2 // Anything more than this hits the limit of the earth textures\n#endif\n\n#ifdef USE_DIFFUSE\n    uniform float uDiffuseScale;\n    \n	#ifdef USE_UDIMS\n		uniform sampler2D tDiffuseArray[MAX_UDIMS];\n\n		// Need separate function calls for each type of texture because on some devices arrays of textures can't be passed as function parameters\n		vec4 getDiffuseUDIMcolor(float textureIndx, vec2 udimuv, float textureScale) {\n			switch (int(textureIndx)) {\n				case 0:\n					return texture( tDiffuseArray[0], udimuv * textureScale);\n					break;\n				case 1:\n					return texture( tDiffuseArray[1], udimuv * textureScale);\n					break;\n				// case 2:\n				// 	return texture2D( tDiffuseArray[2], udimuv * textureScale );\n				// 	break;\n			}\n		}\n	#else\n		uniform sampler2D tDiffuse;\n	#endif\n	\n#endif\n\n#ifdef USE_NORMAL\n\n	uniform float uNormalScale;\n    uniform float uNormalStrength;\n\n	#ifdef USE_UDIMS\n		uniform sampler2D tNormalArray[MAX_UDIMS];\n\n		vec4 getNormalUDIMcolor(float textureIndx, vec2 udimuv, float textureScale) {\n			switch (int(textureIndx)) {\n				case 0:\n					return texture( tNormalArray[0], udimuv * textureScale);\n					break;\n				case 1:\n					return texture( tNormalArray[1], udimuv * textureScale);\n					break;\n				// case 2:\n				// 	return texture2D( tNormalArray[2], udimuv * textureScale );\n				// 	break;\n			}\n		}\n	#else\n		uniform sampler2D tNormal;\n	#endif\n    \n#endif\n\n#ifdef USE_ROUGH\n\n	uniform float uRoughnessScale;\n\n	#ifdef USE_UDIMS\n		uniform sampler2D tRoughnessArray[MAX_UDIMS];\n\n		vec4 getRoughUDIMcolor(float textureIndx, vec2 udimuv, float textureScale) {\n			switch (int(textureIndx)) {\n				case 0:\n					return texture( tRoughnessArray[0], udimuv * textureScale);\n					break;\n				case 1:\n					return texture( tRoughnessArray[1], udimuv * textureScale);\n					break;\n				// case 2:\n				// 	return texture2D( tRoughnessArray[2], udimuv * textureScale );\n				// 	break;\n			}\n		}\n	#else\n		uniform sampler2D tRoughness;\n	#endif\n    \n#endif\n\n#ifdef USE_METALNESS\n	uniform sampler2D tMetalness;\n    uniform float uMetalnessScale;\n#endif\n\n#ifdef USE_EMISSIVEMAP\n    uniform sampler2D tEmissiveMap;\n#endif\n\n#ifdef USE_LIGHTMAP\n    uniform sampler2D tLightMap;\n	uniform float uLightMapIntensity;\n#endif\n\nvarying vec4 vWorldPosition;\nuniform float uRoughness;\nuniform float uIOR;\n\n#ifdef USE_ENV\n\n    uniform sampler2D tEnvMap;\n    uniform float uEnvMapStrength;\n    \n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n        vec3 reflectVec = reflect( - viewDir, normal );\n        // Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n        reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n        reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n        vec4 envMapColor = textureCubeUV( tEnvMap, reflectVec, roughness ); // Sample the mipmapped image\n        return envMapColor.rgb * uEnvMapStrength;\n	}\n\n    vec3 getIBLIrradiance( const in vec3 normal ) {\n\n        vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n        vec4 envMapColor = textureCubeUV( tEnvMap, worldNormal, 1.0 );\n\n        return PI * envMapColor.rgb * uEnvMapStrength;\n\n    }\n\n#endif\n\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\n	return RECIPROCAL_PI * diffuseColor;\n\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in DynamicMaterial material, inout ReflectedLight reflectedLight ) {\n\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\n	float dotNV = saturate( dot( normal, viewDir ) );\n\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n	vec4 r = roughness * c0 + c1;\n\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\n	return fab;\n\n}\n\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n\n	// #ifdef USE_IRIDESCENCE\n\n	// 	vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\n	// #else\n\n	vec3 Fr = specularColor;\n\n	// #endif\n\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21\n	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in DynamicMaterial material, inout ReflectedLight reflectedLight) {\n\n	// Both indirect specular and indirect diffuse light accumulate here\n\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\n    computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n\n\n"),k.vxI.dynamic_frag=H("vec4 diffuseColor = vec4( uColor, uOpacity );\nvec3 totalEmissiveRadiance = uEmissiveColor;\n\nReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n#ifdef USE_UDIMS\n\n	float textureIndex;\n	for(float i = 0.; i < float(USE_UDIMS); i+=1.) {\n		// determine what udim the vertex has\n		textureIndex += step(i + 1., vUv.x); //udim1: 0-1, udim2: 1-2,...\n	}\n\n	vec2 udimUV = (vUv - vec2(textureIndex, 0.0));\n\n#endif\n\n#ifdef USE_DIFFUSE	\n	#ifdef USE_UDIMS\n		diffuseColor *= getDiffuseUDIMcolor(tDiffuseArray, textureIndex, udimUV, uDiffuseScale);\n	#else\n		diffuseColor *= texture2D( tDiffuse, vUv * uDiffuseScale );\n	#endif\n#endif\n\n// Roughness\nfloat roughnessFactor = uRoughness;\n\n#ifdef USE_ROUGH\n\n	#ifdef USE_UDIMS\n		vec4 texelRoughness = getRoughUDIMcolor( tRoughnessArray, textureIndex, udimUV, uRoughnessScale);\n	#else\n		vec4 texelRoughness = texture2D( tRoughness, vUv * uRoughnessScale);\n	#endif\n\n	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n	roughnessFactor *= texelRoughness.g;\n\n#endif\n\n// Metalness\nfloat metalnessFactor = uMetalness;\n\n#ifdef USE_METALNESS\n\n	vec4 texelMetalness = texture2D( tMetalness, vUv * uMetalnessScale );\n	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n	metalnessFactor *= texelMetalness.b;\n\n#endif\n\n// Normals\nfloat faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\n	vec3 normal = normalize( vNormal );\n\n	vec3 tangent = normalize( vTangent );\n	vec3 bitangent = normalize( vBitangent );\n\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n		tangent = tangent * faceDirection;\n		bitangent = bitangent * faceDirection;\n	#endif\n\n	mat3 vTBN = mat3( tangent, bitangent, normal );\n\n#endif\n\n// non perturbed normal for clearcoat among others\nvec3 geometryNormal = normal;\n\n// Normal map\n#ifdef USE_NORMAL\n\n	#ifdef OBJECTSPACE_NORMALMAP\n\n		normal = texture2D( tNormal, vUv * uNormalScale ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n		\n		#ifdef FLIP_SIDED\n			normal = - normal;\n		#endif\n		\n		#ifdef DOUBLE_SIDED\n			normal = normal * faceDirection;\n		#endif\n		\n		normal = normalize( normalMatrix * normal );\n	\n	#else \n		// Tangent space normal maps\n\n		#ifdef USE_UDIMS\n			vec3 mapN = getNormalUDIMcolor( tNormalArray, textureIndex, udimUV, uNormalScale).rgb * 2.0 - 1.0;\n		#else\n			vec3 mapN = texture2D( tNormal, vUv * uNormalScale ).xyz * 2.0 - 1.0;\n		#endif\n\n		mapN.xy *= uNormalStrength;\n		normal = normalize( vTBN * mapN );\n	\n	#endif\n\n#endif\n\n// Emissive maps\n#ifdef USE_EMISSIVEMAP\n\n	vec4 emissiveColor = texture2D( tEmissiveMap, vUv );\n\n	totalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n\n// Matcap\n#ifdef USE_MATCAP\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n	vec4 matcapColor = texture2D( tMatcap, uv );\n#else\n	vec4 matcapColor = vec4(1.); // default if matcap is missing\n#endif\n\n// Lights accumulation\nDynamicMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n\nmaterial.ior = uIOR;\n\nfloat specularIntensityFactor;\nvec3 specularColorFactor;\n\nspecularIntensityFactor = uSpecularIntensity;\nspecularColorFactor = uSpecularColor;\n\nmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\nmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n\n// More lights\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n// Starting ambient\nvec3 ambientLightColor = vec3(0.0);\n// Indirect diffuse\nvec3 iblIrradiance = vec3( 0.0 );\nvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n// Indirect specular\nvec3 radiance = vec3( 0.0 );\nvec3 clearcoatRadiance = vec3( 0.0 );\n\n#ifdef USE_LIGHTMAP \n\n	vec4 lightMapTexel = texture2D( tLightMap, vUv );\n	vec3 lightMapIrradiance = lightMapTexel.rgb * uLightMapIntensity;\n\n	irradiance += lightMapIrradiance;\n\n#endif\n\n#ifdef USE_ENV\n\n	iblIrradiance += getIBLIrradiance( geometry.normal );\n	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\n#endif\n\nRE_IndirectDiffuse_Physical( irradiance, geometry, material, reflectedLight );\nRE_IndirectSpecular_Physical( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\nvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\nvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\nvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n// Mix between outgoing and matcap\n#ifdef USE_MATCAP\n\n	if(uMatcapBlendMode == 0) {\n		outgoingLight = blendSoftLight(outgoingLight.rgb, matcapColor.rgb, uDiffuseMatcapBlend);\n	} else if(uMatcapBlendMode == 1){\n		outgoingLight = blendLinearLight(outgoingLight.rgb, matcapColor.rgb, uDiffuseMatcapBlend);\n	} else if(uMatcapBlendMode == 2){\n		outgoingLight = blendLighten(outgoingLight.rgb, matcapColor.rgb, uDiffuseMatcapBlend);\n	} else if(uMatcapBlendMode == 3){\n		outgoingLight = blendOverlay(outgoingLight.rgb, matcapColor.rgb, uDiffuseMatcapBlend);\n	} else if(uMatcapBlendMode == 4){\n		outgoingLight = blendAdd(outgoingLight.rgb, matcapColor.rgb, uDiffuseMatcapBlend);\n	} else {\n		outgoingLight = blendMultiply(outgoingLight.rgb, matcapColor.rgb, uDiffuseMatcapBlend);\n	}\n\n#endif\n\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );"),k.vxI.dynamic_highlight_frag_pars=H("uniform vec3 uLightPos;\nuniform vec3 uLightColor;\nuniform vec3 uAmbient;\nuniform float uExtraSpecularStrength;\nuniform float uShininess;"),k.vxI.dynamic_highlight_frag=H("// Extra diffuse + specular\nvec3 lightDirection = normalize(uLightPos - vWorldPosition.xyz);\n\n#ifdef USE_HIGHLIGHT_DIFFUSE\n    float diffuseFactor = max(dot(normalize(vNormal), lightDirection), 0.0);\n    vec3 diffuse = diffuseFactor * uLightColor;\n#else \n    vec3 diffuse = vec3(0.0);\n#endif\n\nvec3 viewDirExtra = normalize(cameraPosition - vWorldPosition.xyz);\nvec3 reflectDir = reflect(-lightDirection, normalize(vNormal));\n\nfloat specularFactor = pow(max(dot(viewDirExtra, reflectDir), 0.0), uShininess);\nvec3 specular = uExtraSpecularStrength * specularFactor * uLightColor;\n\ngl_FragColor.rgb = (uAmbient + diffuse + specular) * gl_FragColor.rgb;"),k.fCn.msdf={uOpacity:{value:1},uColor:{value:new b.Q1f("#FFFFFF")},uFontBase:{value:0},uFontLineHeight:{value:0},uFontSize:{value:0},uLayoutDescender:{value:0},uLayoutAscender:{value:0}},k.fCn.msdfBaseAnim={uProgress:{value:0},uStagger:{value:0}},this.init()}}eA.Viewport={w:0,lvh:0,svh:0,dvh:0,h:0,ratio:0,dpr:ez(),isTouch:eN(),isMobile:e_(),isTablet:!e_()&&eP(),isDesktop:!e_()&&!eP()};let eV=eA,eF=e=>{let n={x:0,y:0};return"touches"in e?(n.x=e.touches[0].clientX,n.y=e.touches[0].clientY):(n.x=e.clientX,n.y=e.clientY),n};class eT{enable(){this.enabled=!0}disable(){this.enabled=!1,this.status=!1,this.start.x=0,this.start.y=0,this.end.x=0,this.end.y=0}handleRotation(e){if(!this.enabled||!this.status)return;let n=eF(e);this.end.x=n.x,this.end.y=n.y,this.delta.subVectors(this.end,this.start).multiplyScalar(this.speed),this.sphericalDelta.theta-=2*Math.PI*this.delta.x/eV.Viewport.h,eN()||(this.sphericalDelta.phi-=2*Math.PI*this.delta.y/eV.Viewport.h),this.start.copy(this.end),eN()&&Math.abs(this.delta.y)<Math.abs(this.delta.x)&&e.preventDefault(),this.update()}handleParallax(e){if(!this.enabledParallax||eN())return;let n=eF(e);this.start.x=eV.Viewport.w/2,this.start.y=eV.Viewport.h/2,this.end.x=n.x,this.end.y=n.y,this.delta.subVectors(this.end,this.start).multiplyScalar(.1),this.sphericalDelta.theta=2*Math.PI*this.delta.x/eV.Viewport.h*.1,this.sphericalDelta.phi=2*Math.PI*this.delta.y/eV.Viewport.h*.1,this.update()}update(){this.updateRotation(),this.updateParallax()}updateRotation(){this.enabled&&(!this.status&&this.enabled&&(this.autoRotateY&&(this.sphericalDelta.theta+=this.autoRotateYSpeed*this.autoRotateYAmound),this.autoRotateX&&(this.sphericalDelta.phi+=this.autoRotateXSpeed*this.autoRotateXAmound)),this.damping?(this.spherical.theta+=this.sphericalDelta.theta*this.dampingFactor,this.spherical.phi+=this.sphericalDelta.phi*this.dampingFactor):(this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi),this.object.rotation.y=-this.spherical.theta,this.object.rotation.x=-this.spherical.phi,this.object.rotation.x=b.cj9.clamp(this.object.rotation.x,-Math.PI/4,Math.PI/4),this.damping?(this.sphericalDelta.theta*=.95,this.sphericalDelta.phi*=.95):this.sphericalDelta.set(0,0,0))}updateParallax(){if(!this.enabledParallax)return;let e=-(this.spherical.theta+b.cj9.clamp(this.sphericalDelta.theta,-(Math.PI/10),Math.PI/10)),n=-(this.spherical.phi+b.cj9.clamp(this.sphericalDelta.phi,-(Math.PI/10),Math.PI/10));this.object.rotation.y=b.cj9.lerp(this.object.rotation.y,e,.01),this.object.rotation.x=b.cj9.lerp(this.object.rotation.x,n,.01)}build(){this.addEvents()}addEvents(){this.domEl.addEventListener("mousedown",this.onPointerDown),this.domEl.addEventListener("mousemove",this.onPointerMove),this.domEl.addEventListener("mouseup",this.onPointerUp),this.domEl.addEventListener("mouseleave",this.onPointerUp),this.domEl.addEventListener("touchstart",this.onPointerDown),this.domEl.addEventListener("touchmove",this.onPointerMove),this.domEl.addEventListener("touchend",this.onPointerUp)}destroy(){this.removeEvents()}removeEvents(){this.domEl.removeEventListener("mousedown",this.onPointerDown),this.domEl.removeEventListener("mousemove",this.onPointerMove),this.domEl.removeEventListener("mouseup",this.onPointerUp),this.domEl.removeEventListener("mouseleave",this.onPointerUp),this.domEl.removeEventListener("touchstart",this.onPointerDown),this.domEl.removeEventListener("touchmove",this.onPointerMove),this.domEl.removeEventListener("touchend",this.onPointerUp)}constructor(e){this.damping=!1,this.dampingFactor=1,this.speed=1,this.status=!1,this.delta=new b.I9Y,this.start=new b.I9Y,this.end=new b.I9Y,this.enabled=!0,this.enabledParallax=!1,this.autoRotateX=!1,this.autoRotateXSpeed=1,this.autoRotateXAmound=5e-4,this.autoRotateY=!0,this.autoRotateYSpeed=1,this.autoRotateYAmound=5e-4,this.spherical=new b.YHV,this.sphericalDelta=new b.YHV,this.onPointerDown=e=>{if(!this.enabled)return;this.status=!0;let n=eF(e);this.start.x=n.x,this.start.y=n.y},this.onPointerMove=e=>{this.handleRotation(e),this.handleParallax(e)},this.onPointerUp=()=>{this.enabled&&(this.status=!1)},this.object=e.object,void 0!==e.domEl?this.domEl=e.domEl:this.domEl=eV.instance.renderer.domElement,void 0!==e.damping&&(this.damping=e.damping),void 0!==e.dampingFactor&&(this.dampingFactor=e.dampingFactor),void 0!==e.speed&&(this.speed=e.speed),void 0!==e.enabled&&(this.enabled=e.enabled)}}class ek extends W{constructor(e={}){super(e=(0,G.D9)({vertexShader:"varying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vLocalPosition;\nvarying vec3 vCenter;\nvarying vec3 vScale;\n\nvoid main()	{\n    vUv = uv;\n\n    vec3 scale = vec3(length(modelMatrix[0].xyz), length(modelMatrix[1].xyz), length(modelMatrix[2].xyz));\n    vScale = scale;\n\n    vec4 transformedPosition = vec4( position, 1.0 );\n    vLocalPosition = transformedPosition.xyz;\n\n    vec4 mPosition = modelMatrix * transformedPosition;\n    vPosition = mPosition.xyz;\n\n    vec4 mCenter = modelMatrix * vec4(0.0, 0.0, 0.0, 1.0);\n    vCenter = mCenter.xyz;\n\n    vec4 mNormal = modelMatrix * vec4( normal, 0.0 );\n    vNormal = mNormal.xyz;\n\n    vec4 mvPosition = modelViewMatrix * transformedPosition;\n\n    gl_Position = projectionMatrix * mvPosition;\n}\n",fragmentShader:"#include <default_pars>\n#include <default_frag_pars>\n\n#include <directional_light_pars>\n#include <point_light_pars>\n#include <spot_light_pars>\n#include <cnoise_pars>\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vLocalPosition;\nvarying vec3 vCenter;\nvarying vec3 vScale;\n\nuniform sampler2D tMap;\n\nuniform vec3 uBaseColor1;\nuniform vec3 uBaseColor2;\nuniform float uEarthAlpha;\nuniform float uNoiseScale;\nuniform float uNoiseSeed;\nuniform float uNoiseSpeed;\nuniform float uTime;\nuniform float uAlpha;\n\nuniform bool uDevCameraActive;\n\n// RIGHT LIGHT\nuniform vec3 uLight1Color;\nuniform vec3 uLight1Position;\nuniform float uLight1Intensity;\nuniform vec2 uLight1Specular;\n\n// LEFT LIGHT\nuniform vec3 uLight2Color;\nuniform vec3 uLight2Position;\nuniform float uLight2Intensity;\nuniform vec2 uLight2Specular;\n\n// LEFT RIM LIGHT\nuniform vec3 uLight3Color;\nuniform vec3 uLight3Position;\nuniform float uLight3Intensity;\nuniform vec2 uLight3Specular;\n\n// RIGHT RIM LIGHT\nuniform vec3 uLight4Color;\nuniform vec3 uLight4Position;\nuniform float uLight4Intensity;\nuniform vec2 uLight4Specular;\nuniform float uLight4Decay;\n\n// MOUSE LIGHT\nuniform vec3 uLight5Color;\nuniform vec3 uLight5Position;\nuniform float uLight5Intensity;\nuniform vec2 uLight5Specular;\nuniform float uLight5Decay;\nuniform vec2 uLight5Cutoff;\n\nvoid main() {\n    vec3 normal = normalize(vNormal);\n    vec3 viewDirection = normalize(vPosition - cameraPosition);\n    vec4 earth = texture2D(tMap, vUv);\n\n    float normalizedX = ((vPosition.x - vCenter.x) / vScale.x);\n    float normalizedY = ((vPosition.y - vCenter.y) / vScale.y);\n\n    vec3 color = mix(uBaseColor1, uBaseColor2, map(normalizedX, -.5, .5, 0., 1.));\n    vec3 darken = mix(vec3(0.), vec3(1.), map(normalizedY, -.5, .5, 0., 1.));\n\n    float noise = cnoise( vec3( vec2(normalizedX, normalizedY) * uNoiseScale, sin(uNoiseSeed * (uTime * uNoiseSpeed)) ) );\n    noise = map(noise, 0., 1., 0.5, 1.);\n\n    color *= darken;\n    color *= darken;\n\n    color *= 1. - darken;\n    color += color * (1. - earth.g) * uEarthAlpha;\n\n    color *= (1. - noise);\n\n    vec3 light = vec3(0.);\n\n    // LIGHT\n    light += directionalLight(\n        uLight1Color,\n        uLight1Intensity,\n        uLight1Specular,\n        uLight1Position,\n        normal,\n        viewDirection\n    );\n\n    light += directionalLight(\n        uLight2Color,\n        uLight2Intensity,\n        uLight2Specular,\n        uLight2Position,\n        normal,\n        viewDirection\n    );\n\n    light += directionalLight(\n        uLight3Color,\n        uLight3Intensity,\n        uLight3Specular,\n        uLight3Position,\n        normal,\n        viewDirection\n    );\n\n    light += pointLight(\n        uLight4Color,\n        uLight4Intensity,\n        uLight4Specular,\n        uLight4Position,\n        normal,\n        viewDirection,\n        vPosition,\n        uLight4Decay\n    );\n\n    light += spotLight(\n        uLight5Color,\n        uLight5Intensity,\n        uLight5Specular,\n        uLight5Position,\n        normal,\n        viewDirection,\n        vPosition,\n        uLight5Decay,\n        vPosition,\n        uLight5Cutoff.x,\n        uLight5Cutoff.y\n    );\n\n    color *= light;\n\n    gl_FragColor = vec4(color, uAlpha);\n\n    #include <tonemapping_frag>\n    #include <colorspace_fragment>\n}\n",uniforms:{uBaseColor1:{value:new b.Q1f("#4c22a0")},uBaseColor2:{value:new b.Q1f("#7E01D2")},uEarthAlpha:{value:.5},uNoiseScale:{value:1.84},uNoiseSeed:{value:.57},uNoiseSpeed:{value:.001},uColor:{value:new b.Q1f(0xffffff),gui:{tooltip:"Base colour. It won't do anything at the moment."}},tMap:{value:new b.gPd},uAlpha:{value:1}},transparent:!0},e))}}var eB=t(84103);function ej(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=new b.Pq0;return new b.NRn().setFromObject(e,n).getSize(t),t}function eO(e){return(e+Math.PI)%(2*Math.PI)-Math.PI}let eH=function(e,n){let t=ej(n),{phi:i,theta:a}={phi:Math.PI/180*(90-e.lat),theta:Math.PI/180*(e.lng+180)};return new b.Pq0(-(t.x/2*(Math.sin(i)*Math.cos(a))),t.x/2*Math.cos(i),t.x/2*(Math.sin(i)*Math.sin(a)))},eG=new b.Pq0,eW=(e,n,t)=>{let i=((e,n)=>(eG.set(0,0,0),e.updateMatrixWorld(),eG.setFromMatrixPosition(e.matrixWorld),eG.project(n),eG))(e,n);return i.x=i.x*(t.width/2)+t.width/2,i.y=-(i.y*(t.height/2))+t.height/2,i};class eY extends J(b.B69){build(){if(eB.A.gltfs["/webgl/models/globe.glb"].value&&(this.assets.models.globe=eB.A.gltfs["/webgl/models/globe.glb"].value.asset.scene.children[0]),eB.A.textures["/webgl/textures/globe.webp"].value){var e;this.assets.textures.globe=this.WebGL.generateTexture(eB.A.textures["/webgl/textures/globe.webp"].value.asset,null==(e=eB.A.textures["/webgl/textures/globe.webp"].value)?void 0:e.options)}this.add(this.wrapper),this.buildMesh()}buildMesh(){let e=this.assets.models.globe instanceof b.eaF?this.assets.models.globe.geometry.clone():new b.Gu$(.5,32,32);this.material=new ek({uniforms:{tMap:{value:this.assets.textures.globe},uLight1Color:{value:new b.Q1f("#E900FF")},uLight1Position:{value:new b.Pq0(3,0,3)},uLight1Intensity:{value:1.3},uLight1Specular:{value:new b.I9Y(0,0)},uLight2Color:{value:new b.Q1f("#2C0377")},uLight2Position:{value:new b.Pq0(-3,0,3)},uLight2Intensity:{value:1},uLight2Specular:{value:new b.I9Y(0,0)},uLight3Color:{value:new b.Q1f("#ff00e3")},uLight3Position:{value:new b.Pq0(-3.2,0,-7.5)},uLight3Intensity:{value:3.5},uLight3Specular:{value:new b.I9Y(19.9,22.1)},uLight4Color:{value:new b.Q1f("#ffffff")},uLight4Position:{value:new b.Pq0(55.6,-4.75,-131.4)},uLight4Intensity:{value:2.8},uLight4Specular:{value:new b.I9Y(10.1,40.1)},uLight4Decay:{value:.3},uLight5Color:{value:new b.Q1f("#ff00af")},uLight5Position:{value:new b.Pq0},uLight5Intensity:{value:2.6},uLight5Specular:{value:new b.I9Y(0,0)},uLight5Decay:{value:.2},uLight5Cutoff:{value:new b.I9Y(.7,1.1)}}}),this.mesh=new b.eaF(e,this.material),this.mesh.name="Globe",this.wrapper.add(this.mesh),this.size=ej(this.mesh)}buildCoords(e,n){this.wrapper.add(this.coords);for(let t=0;t<e.length;t++){let i=e[t],a=n[t],o=this.buildAnchor(i),r=new b.B69;this.add(r),this.points.push({el:a,anchor:o,tracking:r,coords:i,bounds:a.getBoundingClientRect()})}}buildAnchor(e){let n=new b.B69;return n.position.copy(eH(e,this.mesh)),this.coords.add(n),n.userData.position=n.position.clone(),n}buildControls(e){this.controls=new eT({...e,object:this.wrapper,damping:!0,dampingFactor:.05}),this.controls.build()}bound(e){this.el=e,this.resize()}goTo(e,n,t){if(this.controls){this.controls.disable(),this.controls.enabledParallax=!1;let i=eH({lat:e,lng:n},this.mesh),a=i.normalize().length(),o=Math.acos(i.y/a)-Math.PI/2,r=-(Math.atan2(i.z,i.x)-Math.PI/2),s={progress:0,scale:this.wrapper.scale.x},l=eO(-this.controls.object.rotation.y),c=eO(-this.controls.object.rotation.x);(0,g.i)(s,{progress:1,scale:eV.Viewport.isMobile?1.3:1.65},{delay:.3,ease:x.SD,duration:1.5,onUpdate:()=>{if(this.controls){let e=eO(r-l),n=eO(o-c);this.controls.spherical.theta=l+e*s.progress,this.controls.spherical.phi=c+n*s.progress,this.wrapper.rotation.y=-this.controls.spherical.theta,this.wrapper.rotation.x=-this.controls.spherical.phi,this.wrapper.scale.set(s.scale,s.scale,s.scale)}},onComplete:()=>{this.controls&&(this.controls.sphericalDelta.theta=0,this.controls.sphericalDelta.phi=0,this.controls.enabledParallax=!0),t&&t()}})}}back(e){if(this.controls&&!this.controls.enabled){this.controls.enabledParallax=!1;let n={progress:0,scale:this.wrapper.scale.x},t=eO(-this.controls.object.rotation.y),i=eO(-this.controls.object.rotation.x);(0,g.i)(n,{progress:1,scale:1},{delay:.3,ease:x.SD,duration:1.5,onUpdate:()=>{this.controls&&(this.wrapper.scale.set(n.scale,n.scale,n.scale),this.controls.spherical.theta=t,this.controls.spherical.phi=i*(1-n.progress),this.wrapper.rotation.x=-this.controls.spherical.phi)},onComplete:()=>{this.controls&&(this.controls.sphericalDelta.theta=0,this.controls.sphericalDelta.phi=0,this.controls.enable()),e&&e()}})}}update(){this.updateTracking(),this.updateRotation(),this.updatePoints(),this.updateLight()}updateRotation(){this.controls&&this.controls.update()}updatePoints(){for(let e=0;e<this.points.length;e++){let{el:n,anchor:t,tracking:i}=this.points[e];if(Number(n.dataset.active)){this.dummy.position.copy(t.position).applyMatrix4(this.wrapper.matrix),i.position.copy(this.dummy.position);let e=eW(i,this.scene.camera,{width:eV.Viewport.w,height:eV.Viewport.h});n.style.transform="translate(-50%, -50%) translate3d(".concat(e.x,"px, ").concat(e.y,"px, 0)"),this.controls&&this.controls.enabled&&(n.style.setProperty("--visible",this.dummy.position.z<=.1?"0":"1"),this.dummy.position.z<=.1?n.style.pointerEvents="none":n.style.removeProperty("pointer-events"))}}}updateTracking(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.el){let n=this.el.getBoundingClientRect(),t=eC(this.scene.activeCamera,{x:n.width,y:n.height}).x,i=eE(this.scene.activeCamera,{x:t,y:t},{x:n.x,y:n.y}),a=window.getComputedStyle(this.el).getPropertyValue("--opacity");this.material.uniforms.uAlpha.value=parseFloat(a),e?(this.position.x=i.x,this.position.y=i.y,this.scale.set(t,t,t)):(this.dummy.position.set(i.x,i.y,0),this.dummy.scale.set(t,t,t),this.position.lerp(this.dummy.position,.15),this.scale.lerp(this.dummy.scale,.15),this.dummy.position.set(0,0,0),this.dummy.scale.set(1,1,1))}}updateLight(){!eN()&&(this.ray.origin.set(0,0,0),this.dummy.position.set(this.WebGL.pointer.gl.x,this.WebGL.pointer.gl.y,500),this.ray.direction.copy(this.dummy.position.normalize()),this.ray.at(this.size.x/2*this.wrapper.scale.x,this.dummy.position),this.mesh.material instanceof ek&&this.mesh.material.uniforms.uLight5Position.value.copy(this.dummy.position.multiplyScalar(10)))}stop(){super.stop(),this.wrapper.remove(this.mesh),this.mesh.geometry.dispose(),this.mesh.material instanceof b.imn&&this.mesh.material.dispose();for(let e=0;e<this.points.length;e++){let{anchor:n,tracking:t}=this.points[e];this.coords.remove(n),this.wrapper.remove(t)}this.points=[],this.controls&&this.controls.destroy()}resize(){this.updateTracking();for(let e=0;e<this.points.length;e++){let{el:n}=this.points[e];n.removeAttribute("style"),this.points[e].bounds=n.getBoundingClientRect()}}load(){}addGui(){this.WebGL.Gui&&this.WebGL.Gui.autoAddObject({object:this.mesh})}constructor(){super(),this.wrapper=new b.B69,this.coords=new b.B69,this.dummy=new b.B69,this.ray=new b.RlV,this.points=[],this.init({name:"Globe"})}}var eq=t(31134),eQ=t.n(eq);let eX=e=>{let{data:n,scrollTrigger:t,webglRef:i}=e,o=(0,R.A)("(min-width: 1025px)"),s=(0,r.useRef)(null),l=(0,r.useRef)(null),c=(0,r.useRef)([]),u=(0,r.useRef)([]),d=(0,r.useRef)(null),h=(0,r.useRef)(null),[m,v]=(0,r.useState)(!1),[y,w]=(0,r.useState)(!1),[L,S]=(0,r.useState)(-1),[D,C]=(0,r.useState)(-1),{isLoaderComplete:E}=(0,F.D)(),I=(0,T.x)(),{hideAmbientLight:U,showAmbientLight:z,isVisible:N,setOpacity:k}=(0,V.S)(),B=n.flatMap((e,n)=>{var t,i;return null!=(i=null==(t=e.items)?void 0:t.map((e,t)=>({region:n,index:t,name:e.name,lat:e.lat,lng:e.lng,count:e.count})))?i:[]}).sort((e,n)=>e.name.localeCompare(n.name));(0,r.useEffect)(()=>{i.current&&E&&i.current.activeScene instanceof eM&&i.current.activeScene.components.globe.controls&&(0===t.activeSection&&t.isInView?i.current.activeScene.components.globe.controls.autoRotateYSpeed=1+Math.abs(t.velocityFactor):i.current.activeScene.components.globe.controls.autoRotateYSpeed=1)},[t.velocityFactor,t.activeSection,i.current,E]),(0,r.useEffect)(()=>{i.current&&E&&d.current&&i.current.activeScene instanceof eM&&i.current.activeScene.components.globe.bound(d.current)},[i,E,d,o]),(0,r.useEffect)(()=>{null!==o&&G(),h.current&&(h.current.time=h.current.duration*t.scrollYProgress)},[o,d]),(0,r.useEffect)(()=>{i.current&&E&&c.current.length===n.length&&u.current.length===B.length&&i.current.activeScene instanceof eM&&0===i.current.activeScene.components.globe.points.length&&(i.current.activeScene.components.globe.buildCoords(n,c.current),i.current.activeScene.components.globe.buildCoords(B,u.current))},[i,E,c.current.length,u.current.length]),(0,r.useEffect)(()=>(s.current&&i.current&&E&&i.current.activeScene instanceof eM&&i.current.activeScene.components.globe.buildControls({domEl:s.current}),()=>{if(s.current&&i.current&&E&&i.current.activeScene instanceof eM){var e;null==(e=i.current.activeScene.components.globe.controls)||e.destroy()}}),[i,E]),(0,r.useEffect)(()=>{h.current&&(h.current.time=h.current.duration*t.scrollYProgress)},[h,t.scrollYProgress,o]),(0,r.useEffect)(()=>{E&&!t.isInView&&z();let e=+(3===t.activeSection),n=Math.max(b.cj9.mapLinear(t.sectionProgress,.5,1,0,1)*e,0),a=+(0===t.activeSection),o=Math.max(b.cj9.mapLinear(t.sectionProgress,0,.5,1,0)*a,0);return t.activeSection<2&&(k(o),0===o&&U()),t.activeSection>2&&t.activeSection<4&&(k(n),0===n&&U()),i.current&&E&&i.current.activeScene instanceof eM&&(t.activeSection<4?i.current.activeScene.components.background.setOpacity(1-2*n):i.current.activeScene.components.background.setOpacity(0),0>=i.current.activeScene.components.background.getOpacity()&&(k(1),z())),()=>{k(1)}},[t.isInView,t.scrollYProgress,t.sectionProgress,E,i,N,U,z]);let j=e=>{!y&&(w(!0),i.current&&i.current.activeScene instanceof eM&&(C((null==e?void 0:e.index)||0),i.current.activeScene.components.globe.goTo(e.lat,e.lng,()=>{w(!1)})))},O=()=>{!y&&(w(!0),i.current&&i.current.activeScene.components.globe instanceof eY&&(v(!1),S(n.length),i.current.activeScene.components.globe.back(()=>{I&&(I.start(),w(!1))})))},H=()=>1===t.activeSection&&t.isInView&&t.sectionProgress>=.25||2===t.activeSection&&t.isInView&&t.sectionProgress<=.75,G=()=>{if(h.current&&(h.current.cancel(),h.current.stop()),d.current){let e={"--opacity":0,top:"50%",width:o?"".concat(33.6,"%"):"".concat(76,"%"),y:"-50%",x:"-50%"};h.current=(0,g.i)([[e,{top:"50%",width:o?"".concat(42*.9,"%"):"".concat(85.5,"%"),"--opacity":.8,y:"-50%",x:"-50%"},{duration:.4}],[e,{top:"50%",width:o?"42%":"95%","--opacity":1,y:"-50%",x:"-50%"},{duration:.4}],[e,{top:"50%",width:o?"42%":"95%","--opacity":1,y:"-50%",x:"-50%"},{duration:.4}],[e,{top:"40%",width:o?"71%":"220%","--opacity":1,y:"-50%",x:"-50%"},{duration:.4}]],{onUpdate:()=>{d.current&&(d.current.style.top=e.top,d.current.style.width=e.width,d.current.style.transform="translate(".concat(e.x,", ").concat(e.y,")"),d.current.style.setProperty("--opacity",String(e["--opacity"])))}}),h.current.pause(),h.current.time=0}};return(0,a.jsxs)("div",{className:[eQ().container,t.activeSection>2?eQ().absolute:""].join(" "),ref:s,children:[null!==o&&(0,a.jsx)("div",{ref:d,className:eQ().globe}),(0,a.jsxs)("div",{ref:l,className:eQ().map,children:[n.map((e,n)=>(0,a.jsx)(A,{index:n,name:e.name,ref:c,active:!m,animate:H()&&!m,onPointerDown:()=>((e,n)=>{y||(I&&I.stop(),S(n),v(!0),j(e.items?e.items[0]:e))})(e,n)},n)),B.map((e,n)=>(0,a.jsx)(_,{index:n,focus:D===e.index&&L===e.region,active:m&&L===e.region,animate:m&&L===e.region,ref:u,onPointerDown:()=>j(e)},n)),(0,a.jsx)(f.P.div,{animate:m?{opacity:1}:{opacity:0},transition:{duration:.7,ease:x.we},className:"".concat(eQ().layer," ").concat(eQ().layerTop)}),(0,a.jsx)(f.P.div,{animate:t.activeSection<=2&&t.isInView?{opacity:1}:{opacity:0},transition:{delay:0,duration:.7,ease:x.we},className:"".concat(eQ().layer," ").concat(eQ().layerBottom)}),(0,a.jsxs)("div",{className:eQ().map__back,children:[(0,a.jsx)(f.P.button,{onPointerDown:()=>{let e=n[L],t=D-1;if(0===D){var i;t=((null==(i=e.items)?void 0:i.length)||0)-1}let a=B.find(e=>e.index===t&&e.region===L);a&&j(a)},className:"".concat(eQ().arrow," ").concat(eQ().arrowPrev),initial:{opacity:0},animate:m?{opacity:1}:{opacity:0},transition:{duration:.7,ease:x.we},children:(0,a.jsx)(p.default,{className:eQ().icon,src:"/svg/arrow-left.svg",alt:"Netflix Arrow Left",width:16,height:16})}),(0,a.jsx)(f.P.button,{onPointerDown:O,className:eQ().placeholderButton,initial:{opacity:0},animate:m?{opacity:1}:{opacity:0},transition:{duration:.7,ease:x.we},children:"BACK TO WORLD VIEW"}),(0,a.jsx)(f.P.button,{onPointerDown:()=>{var e;let t=n[L],i=D+1;D===((null==(e=t.items)?void 0:e.length)||0)-1&&(i=0);let a=B.find(e=>e.index===i&&e.region===L);a&&j(a)},className:"".concat(eQ().arrow," ").concat(eQ().arrowNext),initial:{opacity:0},animate:m?{opacity:1}:{opacity:0},transition:{duration:.7,ease:x.we},children:(0,a.jsx)(p.default,{className:eQ().icon,src:"/svg/arrow-right.svg",alt:"Netflix Arrow Right",width:16,height:16})})]}),(0,a.jsx)(P,{activeRegion:L,activeCity:D,data:n,animate:H(),onChange:e=>{if(H()){if(y)return;w(!0),v(!0),I&&I.stop();let t=e.split("-"),a=Number(t[0]),o=Number(t[1]),r=n[a],s=r.items?r.items[o]:null;L!==a&&S(a),D!==o&&C(o),s&&i.current&&i.current.activeScene.components.globe instanceof eY&&i.current.activeScene.components.globe.goTo(s.lat,s.lng,()=>{w(!1)})}},onBack:O,lock:m}),(0,a.jsx)(f.P.div,{className:eQ().onboard,initial:{opacity:0},animate:H()&&!m?{opacity:1}:{opacity:0},transition:{delay:H()?.7*!m:0,duration:.7,ease:x.we},children:(0,a.jsx)("span",{className:eQ().hint,children:"SELECT A REGION TO EXPLORE"})}),(0,a.jsx)(M,{data:n,activeCity:D,activeRegion:L,active:m&&D>=0&&L>=0,animate:m&&D>=0&&L>=0})]})]})};var eJ=t(18488),eZ=t(27147),eK=t.n(eZ);let e$=e=>{let{title:n,text:t,animate:i}=e,o=(0,r.useRef)(null),[s,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{i?(u(!1),l(!0),h(!0)):u(!0)},[i]),(0,a.jsx)(f.P.div,{className:[eK().container,i?eK().active:eK().inactive].join(" "),ref:o,children:(0,a.jsxs)(f.P.div,{className:eK().content,animate:c?{opacity:0}:{opacity:1},onAnimationComplete:()=>{l(!c),h(!c)},transition:{duration:.7*!!c,ease:x.we},children:[(0,a.jsx)("h2",{className:eK().title,children:(0,a.jsx)(eJ.A,{animate:s,"aria-hidden":"true",config:{delay:.066},children:n})}),(0,a.jsx)(f.P.span,{className:eK().text,initial:{opacity:0,y:"20%"},animate:d?{opacity:.6,y:"0%"}:{opacity:0,y:"20%"},transition:{delay:.5,duration:.7,ease:x.we},children:t})]})})};var e0=t(49486),e1=t(28031),e2=t(15900);let e3=[{path:"/webgl/textures/globe.webp",type:"texture",options:{colorSpace:b.er$,wrapping:b.GJx,flipY:!1,minFilter:b.k6q}},{path:"/webgl/models/globe.glb",type:"gltf"}];var e5=t(41436),e4=t.n(e5);let e9=e=>{let{scene:n,ref:t}=e,i=(0,r.useRef)(null),o=(0,r.useRef)(null),{isLoaded:s,isLoaderComplete:l,addPromise:c,setIsLoaderComplete:u,setIsLoaded:d}=(0,F.D)(),[h,m]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{u(!1),d(!1);for(let e=0;e<e3.length;e++){let n=e3[e];switch(n.type){case"texture":c(eB.A.loadTexture(n.path,n.options));break;case"gltf":c(eB.A.loadGltf(n.path))}}return i.current&&(o.current=new eV(i.current,{urlParams:new URLSearchParams(document.location.search),sceneName:n,context:{addPromise:c}}),m(!0)),()=>{o.current&&(o.current.destroy(),(0,Y.WG)(o.current.beforeRender),(0,Y.WG)(o.current.render),window.removeEventListener("resize",o.current.resize),window.removeEventListener("mousemove",o.current.pointerMove),window.removeEventListener("touchmove",o.current.pointerMove))}},[]),(0,r.useEffect)(()=>{o.current&&s&&h&&(t&&(t.current=o.current),Y.Gt.update(o.current.beforeRender,!0),Y.Gt.update(o.current.render,!0),window.addEventListener("resize",o.current.resize),window.addEventListener("mousemove",o.current.pointerMove),window.addEventListener("touchmove",o.current.pointerMove),o.current.build(),o.current.start())},[s,h]),(0,a.jsx)(f.P.div,{className:e4().container,initial:{opacity:0},animate:l?{opacity:1}:{opacity:0},transition:{delay:.25,duration:1.25,ease:"linear"},children:(0,a.jsx)("canvas",{ref:i,style:{width:"100%",height:"100%"}})})};var e6=t(11520);let e7=e=>{var n,t,i,s,l,c,u,d,h,m,g,f,p,b,x,y,w,_,L,S,P,D,C,E,I,U,M,R,z,N;let{primaryCover:A,introTitle:V,introText:T,regions:k,peekabooTitle:B,sections:j}=e,O={fields:{image:{fields:{title:null==B||null==(i=B.fields)||null==(t=i.image)||null==(n=t.fields)?void 0:n.title,file:{url:"https://"+(null==B||null==(u=B.fields)||null==(c=u.image)||null==(l=c.fields)||null==(s=l.file)?void 0:s.url)}}},eyebrow:null==B||null==(d=B.fields)?void 0:d.eyebrow,initialText:null==B||null==(h=B.fields)?void 0:h.initialText,beforeText:null==B||null==(m=B.fields)?void 0:m.beforeText,afterText:null==B||null==(g=B.fields)?void 0:g.afterText,finalText:null==B||null==(f=B.fields)?void 0:f.finalText}},H=[];null==k||k.forEach(e=>{let n=e.fields.cities,t=[];null==n||n.forEach(e=>{t.push({name:e.fields.name,lat:e.fields.lat,lng:e.fields.long,primaryUrl:e.fields.primaryUrl,secondaryUrl:e.fields.secondaryUrl,count:0})});let i={name:e.fields.name,lat:e.fields.lat,lng:e.fields.long,count:0,items:t};H.push(i)});let{setBodyClass:G}=(0,e6.Q)();(0,r.useEffect)(()=>{G("pagePurple")},[G]);let W=(0,r.useRef)(null),Y=(0,o.W)(W,{once:!0,amount:.75}),{isLoaderComplete:q}=(0,F.D)(),Q=(0,r.useRef)(void 0),[X,J]=(0,r.useState)({scrollYProgress:0,sectionProgress:0,activeSection:0,velocityFactor:0,isInView:!1});return(0,a.jsxs)("div",{children:[(0,a.jsx)(e9,{ref:Q,scene:"GlobeScene"}),(0,a.jsx)(e1.A,{fields:{image:{fields:{title:null==A||null==(x=A.fields)||null==(b=x.image)||null==(p=b.fields)?void 0:p.title,file:{url:"https:"+(null==A||null==(L=A.fields)||null==(_=L.image)||null==(w=_.fields)||null==(y=w.file)?void 0:y.url)}}},imageMobile:{fields:{title:null==A||null==(D=A.fields)||null==(P=D.mobileImage)||null==(S=P.fields)?void 0:S.title,file:{url:"https:"+(null==A||null==(U=A.fields)||null==(I=U.mobileImage)||null==(E=I.fields)||null==(C=E.file)?void 0:C.url)}}},eyebrow:null==A||null==(M=A.fields)?void 0:M.eyebrow,title:null==A||null==(R=A.fields)?void 0:R.title,caption:null==A||null==(z=A.fields)?void 0:z.caption,ambientColor:null==A||null==(N=A.fields)?void 0:N.ambientColor}}),(0,a.jsxs)(v,{size:100,count:4,setState:J,children:[(0,a.jsx)(e$,{title:V,text:T,animate:0===X.activeSection&&X.isInView&&q}),(0,a.jsx)(eX,{data:H,webglRef:Q,scrollTrigger:X})]}),(0,a.jsx)("div",{ref:W,style:{display:"flex",justifyContent:"center",height:"100vh"},children:(0,a.jsx)(e0.A,{...O,animate:Y})}),(0,a.jsx)(e2.default,{sections:j})]})}},69528:(e,n,t)=>{Promise.resolve().then(t.bind(t,59790))},73906:e=>{e.exports={name:"styles_name__7z8pI",count:"styles_count__r_jLd",label:"styles_label__KeXvr",container:"styles_container__Z72T0",icon:"styles_icon__AhNOb",active:"styles_active__cnaYG",inactive:"styles_inactive__HjGZj",wrapper:"styles_wrapper__uGDC_",content:"styles_content__zyOvb",contentRow:"styles_contentRow__mQiPK"}},76807:e=>{e.exports={container:"styles_container__iCPC3",focus:"styles_focus__YmMGj",content:"styles_content__CGKxI",wrapper:"styles_wrapper__dRken",icon:"styles_icon__TgGT6",active:"styles_active__TuPeP",inactive:"styles_inactive__vIbcc"}},78200:e=>{e.exports={placeholderButton__1:"styles_placeholderButton__1__BlD7M",placeholderButton__2:"styles_placeholderButton__2__grn_Q",count:"styles_count__kmuxh",label:"styles_label___O987",hint:"styles_hint__zsHfZ",container:"styles_container__CACo1",active:"styles_active__2Oo0B",inactive:"styles_inactive__d5sYV",content:"styles_content__qNb8l",contentRow:"styles_contentRow__nHJ39",name:"styles_name__qWY5O",actions:"styles_actions__jgdcU"}},94083:(e,n,t)=>{"use strict";t.d(n,{LenisProvider:()=>c,x:()=>u});var i=t(95155),a=t(92691),o=t(95124),r=t(94161),s=t(12115);let l=(0,s.createContext)(void 0),c=e=>{let{isEnabled:n=!0,children:t}=e,[c,u]=(0,s.useState)(),d=(0,s.useRef)(new Set);(0,o.E)(function(){if(n){let e=new a.A({autoRaf:!1});return e.on("scroll",e=>{for(let n of d.current)n(e)}),u(e),()=>{e.destroy(),u(void 0)}}},[n]);let h=(0,s.useCallback)(e=>{c&&c.raf(e)},[c]);(0,r.N)(h);let m=(0,s.useMemo)(()=>({lenis:c,addCallback:e=>{d.current.add(e)},removeCallback:e=>{d.current.delete(e)}}),[c]);return(0,i.jsx)(l.Provider,{value:m,children:t})},u=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,s.useContext)(l);if(!t)throw Error("'useLenis' must be used in a component with a parent 'LenisProvider'.");let{lenis:i,addCallback:a,removeCallback:o}=t;return(0,s.useEffect)(()=>{var t;if(e&&(null==(t=n.isEnabled)||t))return a(e),()=>o(e)},[e,n.isEnabled,a,o]),i}}},e=>{e.O(0,[7429,189,1218,6057,1831,4965,9367,8672,3344,8663,5923,7988,2619,2591,777,5395,1252,5900,8441,1255,7358],()=>e(e.s=69528)),_N_E=e.O()}]);